{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.13", "generated_at": "2025-10-26T15:35:14.314732Z", "invocation_id": "e48772b6-c5b0-4bdf-8078-e44e1a92cbe6", "invocation_started_at": "2025-10-26T15:35:13.391717Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.016885Z", "completed_at": "2025-10-26T15:35:14.031629Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.035511Z", "completed_at": "2025-10-26T15:35:14.035530Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.023041963577270508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fentanyl_awareness.stg_cdc_wonder_fentanyl_deaths_final_1999_2020", "compiled": true, "compiled_code": "-- Staging model for CDC WONDER Fentanyl Deaths Final 1999-2020 data\n-- This model cleans and standardizes the raw CDC WONDER data\n\n\n\nwith source_data as (\n    select * from \"fentanyl_awareness\".\"main\".\"multiple_cause_of_death_1999_2020_manual_download\"\n),\n\ncleaned_data as (\n    select\n        -- Clean and standardize columns\n        \"Year Code\" as year\n        , strptime(trim(\"Month Code\"), '%Y/%m')::date as month\n        , trim(\"State\") as state\n        , trim(\"Multiple Cause of death\") as multiple_cause_of_death\n        , trim(\"Multiple Cause of death Code\") as multiple_cause_of_death_code\n        \n        -- Deaths is already an integer, just handle nulls\n        , case \n            when \"Deaths\" is null \n                then 0\n            else \"Deaths\"\n          end as deaths\n\n        -- These columns are available in the raw data, but not needed for our analysis\n        -- , notes -- Always null\n        -- , trim(\"Year\") as year -- String with (provisional and partial sometimes attached) (not needed as we will be prioritizing non-provisional data from other datasets in downstream datasets)\n        -- , trim(\"Month\") as month --Sting representation of the month (Jan., 2018, etc.)\n        -- , \"Residence State Code\" as residence_state_code -- The integer state code is not needed for our analysis\n        -- , population -- Almost always \"Not Applicable\". CDC Wonder attempts to anonymize the data when it is too granular (state, month, etc.)\n        -- , crude_rate -- Almost always \"Not Applicable\". CDC Wonder attempts to anonymize the data when it is too granular (state, month, etc.)\n\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "\"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.024635Z", "completed_at": "2025-10-26T15:35:14.036181Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.037879Z", "completed_at": "2025-10-26T15:35:14.037900Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.024337053298950195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fentanyl_awareness.stg_cdc_wonder_fentanyl_deaths_final_2018_2023", "compiled": true, "compiled_code": "-- Staging model for CDC WONDER Fentanyl Deaths Final 2018-2023 data\n-- This model cleans and standardizes the raw CDC WONDER data\n\n\n\nwith source_data as (\n    select * from \"fentanyl_awareness\".\"main\".\"multiple_cause_of_death_2018_2023_single_race_manual_download\"\n),\n\ncleaned_data as (\n    select\n        -- Clean and standardize columns\n        \"Year Code\" as year\n        , strptime(trim(\"Month Code\"), '%Y/%m')::date as month\n        , trim(\"State\") as state\n        , trim(\"Multiple Cause of death\") as multiple_cause_of_death\n        , trim(\"Multiple Cause of death Code\") as multiple_cause_of_death_code\n        \n        -- Deaths is already an integer, just handle nulls\n        , case \n            when \"Deaths\" is null \n                then 0\n            else \"Deaths\"\n          end as deaths\n\n        -- These columns are available in the raw data, but not needed for our analysis\n        -- , notes -- Always null\n        -- , trim(\"Year\") as year -- String with (provisional and partial sometimes attached) (not needed as we will be prioritizing non-provisional data from other datasets in downstream datasets)\n        -- , trim(\"Month\") as month --Sting representation of the month (Jan., 2018, etc.)\n        -- , \"Residence State Code\" as residence_state_code -- The integer state code is not needed for our analysis\n        -- , population -- Almost always \"Not Applicable\". CDC Wonder attempts to anonymize the data when it is too granular (state, month, etc.)\n        -- , crude_rate -- Almost always \"Not Applicable\". CDC Wonder attempts to anonymize the data when it is too granular (state, month, etc.)\n\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "\"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.028317Z", "completed_at": "2025-10-26T15:35:14.036680Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.039285Z", "completed_at": "2025-10-26T15:35:14.039294Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.024029016494750977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fentanyl_awareness.stg_cdc_wonder_fentanyl_deaths_provisional_2018_current", "compiled": true, "compiled_code": "-- Staging model for D176 Provisional 2018-Current data\n-- This model cleans and standardizes the raw CDC WONDER data\n\n\n\nwith source_data as (\n    select * from \"fentanyl_awareness\".\"main\".\"provisional_mortality_statistics_2018_through_last_week_manual_download\"\n),\n\ncleaned_data as (\n    select\n        -- Clean and standardize columns\n        \"Year Code\" as year\n        , strptime(trim(\"Month Code\"), '%Y/%m')::date as month\n        , trim(\"Residence State\") as state\n        , trim(\"Multiple Cause of death\") as multiple_cause_of_death\n        , trim(\"Multiple Cause of death Code\") as multiple_cause_of_death_code\n        \n        -- Deaths is already an integer, just handle nulls\n        , case \n            when \"Deaths\" is null \n                then 0\n            else \"Deaths\"\n          end as deaths\n\n        -- These columns are available in the raw data, but not needed for our analysis\n        -- , notes -- Always null\n        -- , trim(\"Year\") as year -- String with (provisional and partial sometimes attached) (not needed as we will be prioritizing non-provisional data from other datasets in downstream datasets)\n        -- , trim(\"Month\") as month --Sting representation of the month (Jan., 2018, etc.)\n        -- , \"Residence State Code\" as residence_state_code -- The integer state code is not needed for our analysis\n        -- , population -- Almost always \"Not Applicable\". CDC Wonder attempts to anonymize the data when it is too granular (state, month, etc.)\n        -- , crude_rate -- Almost always \"Not Applicable\". CDC Wonder attempts to anonymize the data when it is too granular (state, month, etc.)\n\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "\"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.032220Z", "completed_at": "2025-10-26T15:35:14.038805Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.041038Z", "completed_at": "2025-10-26T15:35:14.041048Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.024765729904174805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fentanyl_awareness.stg_census_state_economic", "compiled": true, "compiled_code": "-- Staging model for Census Economic Data (ACS)\n-- This model cleans and standardizes state-level economic data from US Census\n\n\n\nwith source_data as (\n    select * from \"fentanyl_awareness\".\"main\".\"census_state_economic\"\n),\n\ncleaned_data as (\n    select\n        -- Clean and standardize columns\n        year\n        , state_code\n        , trim(state_name) as state_name\n        , median_household_income\n        , per_capita_income\n        , unemployment_rate\n        , labor_force_total\n        , employed\n        , unemployed\n        , extracted_at\n        \n        -- Add derived fields\n        , case \n            when median_household_income > 0 \n                then true\n            else false\n          end as has_income_data\n        \n        , case \n            when unemployment_rate is not null \n                then true\n            else false\n          end as has_employment_data\n        \n        -- Add data quality flags\n        , case \n            when median_household_income is null \n                then 'missing'\n            when median_household_income < 20000 \n                then 'low_income'\n            when median_household_income > 150000 \n                then 'high_income'\n            else 'normal'\n          end as income_quality_flag\n        \n        , case \n            when unemployment_rate is null \n                then 'missing'\n            when unemployment_rate < 2.0 \n                then 'very_low'\n            when unemployment_rate > 10.0 \n                then 'very_high'\n            else 'normal'\n          end as unemployment_quality_flag\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "\"fentanyl_awareness\".\"main\".\"stg_census_state_economic\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.049187Z", "completed_at": "2025-10-26T15:35:14.050585Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.054155Z", "completed_at": "2025-10-26T15:35:14.054165Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011211633682250977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.fentanyl_awareness.Multiple_Cause_of_Death_1999_2020_MANUAL_DOWNLOAD", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.044656Z", "completed_at": "2025-10-26T15:35:14.051083Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.054840Z", "completed_at": "2025-10-26T15:35:14.054850Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014961957931518555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fentanyl_awareness.stg_census_state_population", "compiled": true, "compiled_code": "-- Staging model for Census Population Estimates Program (PEP) data\n-- This model cleans and standardizes state-level population data from US Census\n\n\n\nwith source_data as (\n    select * from \"fentanyl_awareness\".\"main\".\"census_state_population\"\n),\n\ncleaned_data as (\n    select\n        -- Clean and standardize columns\n        year\n        , state_code\n        , trim(state_name) as state_name\n        , population\n        , trim(date_description) as date_description\n        , extracted_at\n        \n        -- Add derived fields\n        , case \n            when population > 0 \n                then true\n            else false\n          end as has_population_data\n        \n        -- Add data quality flags\n        , case \n            when population is null \n                then 'missing'\n            when population = 0 \n                then 'zero'\n            when population < 1000000 \n                then 'low_population'\n            else 'normal'\n          end as population_quality_flag\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "\"fentanyl_awareness\".\"main\".\"stg_census_state_population\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.052020Z", "completed_at": "2025-10-26T15:35:14.053646Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.057454Z", "completed_at": "2025-10-26T15:35:14.057464Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.013488292694091797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.fentanyl_awareness.Multiple_Cause_of_Death_2018_2023_Single_Race_MANUAL_DOWNLOAD", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.055567Z", "completed_at": "2025-10-26T15:35:14.056957Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.059426Z", "completed_at": "2025-10-26T15:35:14.059437Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.011475801467895508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.fentanyl_awareness.Provisional_Mortality_Statistics_2018_through_Last_Week_MANUAL_DOWNLOAD", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.064697Z", "completed_at": "2025-10-26T15:35:14.067410Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.083383Z", "completed_at": "2025-10-26T15:35:14.083394Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.022639036178588867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.fentanyl_awareness.census_state_economic", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.067881Z", "completed_at": "2025-10-26T15:35:14.069374Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.084068Z", "completed_at": "2025-10-26T15:35:14.084080Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.022802352905273438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.fentanyl_awareness.census_state_population", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.070288Z", "completed_at": "2025-10-26T15:35:14.093985Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.096025Z", "completed_at": "2025-10-26T15:35:14.096033Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03374361991882324, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.dbt_utils_unique_combination_of_columns_stg_cdc_wonder_fentanyl_deaths_final_1999_2020_year__month__state__multiple_cause_of_death_code.901b8b60d5", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        year, month, state, multiple_cause_of_death_code\n    from \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"\n    group by year, month, state, multiple_cause_of_death_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.084894Z", "completed_at": "2025-10-26T15:35:14.095560Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.097589Z", "completed_at": "2025-10-26T15:35:14.097600Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03391456604003906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_1999_2020_month.cdcff2cc71", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"\nwhere month is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.102786Z", "completed_at": "2025-10-26T15:35:14.108741Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.110555Z", "completed_at": "2025-10-26T15:35:14.110563Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015558958053588867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_1999_2020_multiple_cause_of_death_code.bed7774318", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect multiple_cause_of_death_code\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"\nwhere multiple_cause_of_death_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.098823Z", "completed_at": "2025-10-26T15:35:14.109661Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.114893Z", "completed_at": "2025-10-26T15:35:14.114904Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0205080509185791, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_1999_2020_multiple_cause_of_death.be1f52a345", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect multiple_cause_of_death\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"\nwhere multiple_cause_of_death is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.111196Z", "completed_at": "2025-10-26T15:35:14.121444Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.123259Z", "completed_at": "2025-10-26T15:35:14.123271Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.016038894653320312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_1999_2020_state.1dcc3c474c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"\nwhere state is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.115706Z", "completed_at": "2025-10-26T15:35:14.122377Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.124425Z", "completed_at": "2025-10-26T15:35:14.124438Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01626753807067871, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_1999_2020_year.5e72dabf2b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect year\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"\nwhere year is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.125096Z", "completed_at": "2025-10-26T15:35:14.136032Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.138103Z", "completed_at": "2025-10-26T15:35:14.138112Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0173189640045166, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.dbt_utils_unique_combination_of_columns_stg_cdc_wonder_fentanyl_deaths_final_2018_2023_year__month__state__multiple_cause_of_death_code.325aeb4158", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        year, month, state, multiple_cause_of_death_code\n    from \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"\n    group by year, month, state, multiple_cause_of_death_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.129632Z", "completed_at": "2025-10-26T15:35:14.137639Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.142941Z", "completed_at": "2025-10-26T15:35:14.142958Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02111530303955078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_2018_2023_month.4d97ea0bef", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"\nwhere month is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.139214Z", "completed_at": "2025-10-26T15:35:14.149334Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.151250Z", "completed_at": "2025-10-26T15:35:14.151259Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.015878677368164062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_2018_2023_multiple_cause_of_death.5fbf9c39cd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect multiple_cause_of_death\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"\nwhere multiple_cause_of_death is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.144291Z", "completed_at": "2025-10-26T15:35:14.150358Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.152380Z", "completed_at": "2025-10-26T15:35:14.152388Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.015801191329956055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_2018_2023_multiple_cause_of_death_code.744e8841ce", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect multiple_cause_of_death_code\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"\nwhere multiple_cause_of_death_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.153009Z", "completed_at": "2025-10-26T15:35:14.162354Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.164340Z", "completed_at": "2025-10-26T15:35:14.164348Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015573978424072266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_2018_2023_state.48b1d81ab9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"\nwhere state is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.157366Z", "completed_at": "2025-10-26T15:35:14.163458Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.165497Z", "completed_at": "2025-10-26T15:35:14.165505Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.015655040740966797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_2018_2023_year.3a4ffbdd11", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect year\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"\nwhere year is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.166126Z", "completed_at": "2025-10-26T15:35:14.175761Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.177329Z", "completed_at": "2025-10-26T15:35:14.177339Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01572561264038086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.dbt_utils_unique_combination_of_columns_stg_cdc_wonder_fentanyl_deaths_provisional_2018_current_year__month__state__multiple_cause_of_death_code.54f0f86d80", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        year, month, state, multiple_cause_of_death_code\n    from \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"\n    group by year, month, state, multiple_cause_of_death_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.170526Z", "completed_at": "2025-10-26T15:35:14.177951Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.183138Z", "completed_at": "2025-10-26T15:35:14.183147Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.020344257354736328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_provisional_2018_current_month.37db7c3a62", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"\nwhere month is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.178854Z", "completed_at": "2025-10-26T15:35:14.188986Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.191079Z", "completed_at": "2025-10-26T15:35:14.191088Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015999555587768555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_provisional_2018_current_multiple_cause_of_death.654ce76e47", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect multiple_cause_of_death\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"\nwhere multiple_cause_of_death is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.183870Z", "completed_at": "2025-10-26T15:35:14.190611Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.197591Z", "completed_at": "2025-10-26T15:35:14.197599Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.021340608596801758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_provisional_2018_current_multiple_cause_of_death_code.4265088b0e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect multiple_cause_of_death_code\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"\nwhere multiple_cause_of_death_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.191747Z", "completed_at": "2025-10-26T15:35:14.203259Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.205069Z", "completed_at": "2025-10-26T15:35:14.205085Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.017310380935668945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_provisional_2018_current_state.166d773158", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"\nwhere state is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.198960Z", "completed_at": "2025-10-26T15:35:14.205746Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.207619Z", "completed_at": "2025-10-26T15:35:14.207627Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01755547523498535, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_provisional_2018_current_year.71869994fa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect year\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"\nwhere year is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.212490Z", "completed_at": "2025-10-26T15:35:14.222385Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.223964Z", "completed_at": "2025-10-26T15:35:14.223973Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01956629753112793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_census_state_economic_state_code.9e2bc8eaff", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state_code\nfrom \"fentanyl_awareness\".\"main\".\"stg_census_state_economic\"\nwhere state_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.208296Z", "completed_at": "2025-10-26T15:35:14.222780Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.224693Z", "completed_at": "2025-10-26T15:35:14.224709Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.020972251892089844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.dbt_utils_unique_combination_of_columns_stg_census_state_economic_year__state_code.10b0079039", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        year, state_code\n    from \"fentanyl_awareness\".\"main\".\"stg_census_state_economic\"\n    group by year, state_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.218669Z", "completed_at": "2025-10-26T15:35:14.225368Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.230413Z", "completed_at": "2025-10-26T15:35:14.230422Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01427149772644043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_census_state_economic_state_name.27633bcdad", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state_name\nfrom \"fentanyl_awareness\".\"main\".\"stg_census_state_economic\"\nwhere state_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.225804Z", "completed_at": "2025-10-26T15:35:14.232625Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.234489Z", "completed_at": "2025-10-26T15:35:14.234497Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0164644718170166, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_census_state_economic_year.6ba220ae0f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect year\nfrom \"fentanyl_awareness\".\"main\".\"stg_census_state_economic\"\nwhere year is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.238995Z", "completed_at": "2025-10-26T15:35:14.248197Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.250009Z", "completed_at": "2025-10-26T15:35:14.250025Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018444299697875977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.dbt_utils_unique_combination_of_columns_stg_census_state_population_year__state_code.2f649749e3", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        year, state_code\n    from \"fentanyl_awareness\".\"main\".\"stg_census_state_population\"\n    group by year, state_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.235120Z", "completed_at": "2025-10-26T15:35:14.249535Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.251626Z", "completed_at": "2025-10-26T15:35:14.251635Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.020565509796142578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fentanyl_awareness.fact_fentanyl_deaths_over_time", "compiled": true, "compiled_code": "-- Fact table for CDC WONDER Fentanyl Deaths\n-- This model unions all CDC WONDER data sources and prioritizes older, more reliable data\n\n\n\nwith stg_census_state_population as (\n    select\n        year\n        , state_name as state\n        , population\n    from \"fentanyl_awareness\".\"main\".\"stg_census_state_population\"\n),\n\nstg_census_state_economic as (\n    select\n        year\n        , state_name as state\n        , median_household_income\n        , unemployment_rate\n    from \"fentanyl_awareness\".\"main\".\"stg_census_state_economic\"\n),\n\nwonder_data_union as (\n    -- Union all CDC WONDER data sources (union all since no duplicates expected)\n    select\n        year\n        , month\n        , state\n        , deaths\n        , 'Official 1999-2020' as data_source\n        , 1 as priority\n    from \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"\n\n    union all\n\n    select\n        year\n        , month\n        , state\n        , deaths\n        , 'Official 2018-2023' as data_source\n        , 2 as priority\n    from \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"\n\n    union all\n\n    select\n        year\n        , month\n        , state\n        , deaths\n        , 'Provisional 2018-current' as data_source\n        , 3 as priority\n    from \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"\n),\n\n-- Remove duplicates based on primary keys (year, month, state)\n-- Prioritize older data sources (lower priority number = higher priority)\ndeduplicated_data as (\n    select\n        year\n        , month\n        , state\n        , deaths\n        , data_source\n        , priority\n        , row_number() over (\n            partition by year, month, state\n            order by priority asc\n        ) as row_num\n    from wonder_data_union\n),\n\n-- Final format with coalesced deaths, prioritized data source, and census data\nfinal_format as (\n    select\n        deduplicated_data.year\n        , deduplicated_data.month\n        , deduplicated_data.state\n        , coalesce(deduplicated_data.deaths, 0) as deaths\n        , deduplicated_data.data_source\n        , stg_census_state_population.population\n        , stg_census_state_economic.median_household_income\n        , stg_census_state_economic.unemployment_rate\n    from deduplicated_data\n    left join stg_census_state_population\n        on deduplicated_data.year = stg_census_state_population.year\n        and deduplicated_data.state = stg_census_state_population.state\n    left join stg_census_state_economic\n        on deduplicated_data.year = stg_census_state_economic.year\n        and deduplicated_data.state = stg_census_state_economic.state\n    where deduplicated_data.row_num = 1  -- Keep only the highest priority record for each key\n)\n\nselect * from final_format", "relation_name": "\"fentanyl_awareness\".\"main\".\"fact_fentanyl_deaths_over_time\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.244501Z", "completed_at": "2025-10-26T15:35:14.250706Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.252805Z", "completed_at": "2025-10-26T15:35:14.252816Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01887345314025879, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_census_state_population_population.faaf0834d5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect population\nfrom \"fentanyl_awareness\".\"main\".\"stg_census_state_population\"\nwhere population is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.253517Z", "completed_at": "2025-10-26T15:35:14.260438Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.267158Z", "completed_at": "2025-10-26T15:35:14.267168Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.018422842025756836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_census_state_population_state_code.a933bad448", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state_code\nfrom \"fentanyl_awareness\".\"main\".\"stg_census_state_population\"\nwhere state_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.261282Z", "completed_at": "2025-10-26T15:35:14.275994Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.277445Z", "completed_at": "2025-10-26T15:35:14.277455Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01986408233642578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_census_state_population_state_name.a0a9c261d6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state_name\nfrom \"fentanyl_awareness\".\"main\".\"stg_census_state_population\"\nwhere state_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.267945Z", "completed_at": "2025-10-26T15:35:14.278124Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.280010Z", "completed_at": "2025-10-26T15:35:14.280018Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02107381820678711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_census_state_population_year.286e26da5e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect year\nfrom \"fentanyl_awareness\".\"main\".\"stg_census_state_population\"\nwhere year is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.271562Z", "completed_at": "2025-10-26T15:35:14.279538Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.284797Z", "completed_at": "2025-10-26T15:35:14.284807Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02489614486694336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.dbt_utils_unique_combination_of_columns_fact_fentanyl_deaths_over_time_year__month__state.51d71a6634", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        year, month, state\n    from \"fentanyl_awareness\".\"main\".\"fact_fentanyl_deaths_over_time\"\n    group by year, month, state\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.280677Z", "completed_at": "2025-10-26T15:35:14.287109Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.292267Z", "completed_at": "2025-10-26T15:35:14.292282Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.015546321868896484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_fact_fentanyl_deaths_over_time_data_source.9f81939df3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect data_source\nfrom \"fentanyl_awareness\".\"main\".\"fact_fentanyl_deaths_over_time\"\nwhere data_source is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.288089Z", "completed_at": "2025-10-26T15:35:14.294120Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.302521Z", "completed_at": "2025-10-26T15:35:14.302529Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018383264541625977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_fact_fentanyl_deaths_over_time_deaths.42cfa0ceda", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deaths\nfrom \"fentanyl_awareness\".\"main\".\"fact_fentanyl_deaths_over_time\"\nwhere deaths is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.298626Z", "completed_at": "2025-10-26T15:35:14.304174Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.305692Z", "completed_at": "2025-10-26T15:35:14.305703Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.013987064361572266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_fact_fentanyl_deaths_over_time_state.aebb3a4df9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state\nfrom \"fentanyl_awareness\".\"main\".\"fact_fentanyl_deaths_over_time\"\nwhere state is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.295057Z", "completed_at": "2025-10-26T15:35:14.305186Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.310063Z", "completed_at": "2025-10-26T15:35:14.310073Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.022548198699951172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_fact_fentanyl_deaths_over_time_month.c35ccccd74", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month\nfrom \"fentanyl_awareness\".\"main\".\"fact_fentanyl_deaths_over_time\"\nwhere month is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T15:35:14.306366Z", "completed_at": "2025-10-26T15:35:14.311198Z"}, {"name": "execute", "started_at": "2025-10-26T15:35:14.311651Z", "completed_at": "2025-10-26T15:35:14.311658Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.008564949035644531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_fact_fentanyl_deaths_over_time_year.b81f0f957d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect year\nfrom \"fentanyl_awareness\".\"main\".\"fact_fentanyl_deaths_over_time\"\nwhere year is null\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 0.4148411750793457, "args": {"indirect_selection": "eager", "require_all_warnings_handled_by_warn_error": false, "require_generic_test_arguments_property": true, "favor_state": false, "use_fast_test_edges": false, "select": [], "state_modified_compare_vars": false, "use_colors_file": true, "quiet": false, "require_explicit_package_overrides_for_builtin_materializations": true, "invocation_command": "dbt docs generate --profiles-dir /home/runner/.dbt", "macro_debugging": false, "strict_mode": false, "log_level_file": "debug", "profiles_dir": "/home/runner/.dbt", "require_resource_names_without_spaces": true, "write_json": true, "validate_macro_args": false, "cache_selected_only": false, "log_format": "default", "log_path": "/home/runner/work/fentanyl-awareness/fentanyl-awareness/data_engineering/data_build_tool/logs", "show_all_deprecations": false, "log_format_file": "debug", "version_check": true, "static": false, "log_file_max_bytes": 10485760, "partial_parse": true, "static_parser": true, "log_level": "info", "upload_to_artifacts_ingest_api": false, "require_yaml_configuration_for_mf_time_spines": false, "use_colors": true, "compile": true, "print": true, "require_batched_execution_for_custom_microbatch_strategy": false, "send_anonymous_usage_stats": true, "partial_parse_file_diff": true, "printer_width": 80, "vars": {}, "which": "generate", "show_resource_report": false, "defer": false, "exclude": [], "source_freshness_run_project_hooks": true, "skip_nodes_if_on_run_start_fails": false, "empty_catalog": false, "introspect": true, "populate_cache": true, "require_nested_cumulative_type_params": false, "state_modified_compare_more_unrendered_values": false, "project_dir": "/home/runner/work/fentanyl-awareness/fentanyl-awareness/data_engineering/data_build_tool", "warn_error_options": {"error": [], "warn": [], "silence": []}}}