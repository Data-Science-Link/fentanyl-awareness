{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.13", "generated_at": "2025-10-26T16:51:37.652782Z", "invocation_id": "40b47085-caa1-4a47-9604-d430d95e5b23", "invocation_started_at": "2025-10-26T16:51:36.721599Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.354987Z", "completed_at": "2025-10-26T16:51:37.372845Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.375346Z", "completed_at": "2025-10-26T16:51:37.375363Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.024560928344726562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fentanyl_awareness.stg_cdc_wonder_fentanyl_deaths_final_1999_2020", "compiled": true, "compiled_code": "-- Staging model for CDC WONDER Fentanyl Deaths Final 1999-2020 data\n-- This model cleans and standardizes the raw CDC WONDER data\n\n\n\nwith source_data as (\n    select * from \"fentanyl_awareness\".\"main\".\"multiple_cause_of_death_1999_2020_manual_download\"\n),\n\ncleaned_data as (\n    select\n        -- Clean and standardize columns\n        \"Year Code\" as year\n        , strptime(trim(\"Month Code\"), '%Y/%m')::date as month\n        , trim(\"State\") as state\n        , trim(\"Multiple Cause of death\") as multiple_cause_of_death\n        , trim(\"Multiple Cause of death Code\") as multiple_cause_of_death_code\n        \n        -- Deaths is already an integer, just handle nulls\n        , case \n            when \"Deaths\" is null \n                then 0\n            else \"Deaths\"\n          end as deaths\n\n        -- These columns are available in the raw data, but not needed for our analysis\n        -- , notes -- Always null\n        -- , trim(\"Year\") as year -- String with (provisional and partial sometimes attached) (not needed as we will be prioritizing non-provisional data from other datasets in downstream datasets)\n        -- , trim(\"Month\") as month --Sting representation of the month (Jan., 2018, etc.)\n        -- , \"Residence State Code\" as residence_state_code -- The integer state code is not needed for our analysis\n        -- , population -- Almost always \"Not Applicable\". CDC Wonder attempts to anonymize the data when it is too granular (state, month, etc.)\n        -- , crude_rate -- Almost always \"Not Applicable\". CDC Wonder attempts to anonymize the data when it is too granular (state, month, etc.)\n\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "\"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.366613Z", "completed_at": "2025-10-26T16:51:37.373914Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.376215Z", "completed_at": "2025-10-26T16:51:37.376226Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02290201187133789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fentanyl_awareness.stg_cdc_wonder_fentanyl_deaths_provisional_2018_current", "compiled": true, "compiled_code": "-- Staging model for D176 Provisional 2018-Current data\n-- This model cleans and standardizes the raw CDC WONDER data\n\n\n\nwith source_data as (\n    select * from \"fentanyl_awareness\".\"main\".\"provisional_mortality_statistics_2018_through_last_week_manual_download\"\n),\n\ncleaned_data as (\n    select\n        -- Clean and standardize columns\n        \"Year Code\" as year\n        , strptime(trim(\"Month Code\"), '%Y/%m')::date as month\n        , trim(\"Residence State\") as state\n        , trim(\"Multiple Cause of death\") as multiple_cause_of_death\n        , trim(\"Multiple Cause of death Code\") as multiple_cause_of_death_code\n        \n        -- Deaths is already an integer, just handle nulls\n        , case \n            when \"Deaths\" is null \n                then 0\n            else \"Deaths\"\n          end as deaths\n\n        -- These columns are available in the raw data, but not needed for our analysis\n        -- , notes -- Always null\n        -- , trim(\"Year\") as year -- String with (provisional and partial sometimes attached) (not needed as we will be prioritizing non-provisional data from other datasets in downstream datasets)\n        -- , trim(\"Month\") as month --Sting representation of the month (Jan., 2018, etc.)\n        -- , \"Residence State Code\" as residence_state_code -- The integer state code is not needed for our analysis\n        -- , population -- Almost always \"Not Applicable\". CDC Wonder attempts to anonymize the data when it is too granular (state, month, etc.)\n        -- , crude_rate -- Almost always \"Not Applicable\". CDC Wonder attempts to anonymize the data when it is too granular (state, month, etc.)\n\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "\"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.363378Z", "completed_at": "2025-10-26T16:51:37.374454Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.376920Z", "completed_at": "2025-10-26T16:51:37.376930Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.024640560150146484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fentanyl_awareness.stg_cdc_wonder_fentanyl_deaths_final_2018_2023", "compiled": true, "compiled_code": "-- Staging model for CDC WONDER Fentanyl Deaths Final 2018-2023 data\n-- This model cleans and standardizes the raw CDC WONDER data\n\n\n\nwith source_data as (\n    select * from \"fentanyl_awareness\".\"main\".\"multiple_cause_of_death_2018_2023_single_race_manual_download\"\n),\n\ncleaned_data as (\n    select\n        -- Clean and standardize columns\n        \"Year Code\" as year\n        , strptime(trim(\"Month Code\"), '%Y/%m')::date as month\n        , trim(\"State\") as state\n        , trim(\"Multiple Cause of death\") as multiple_cause_of_death\n        , trim(\"Multiple Cause of death Code\") as multiple_cause_of_death_code\n        \n        -- Deaths is already an integer, just handle nulls\n        , case \n            when \"Deaths\" is null \n                then 0\n            else \"Deaths\"\n          end as deaths\n\n        -- These columns are available in the raw data, but not needed for our analysis\n        -- , notes -- Always null\n        -- , trim(\"Year\") as year -- String with (provisional and partial sometimes attached) (not needed as we will be prioritizing non-provisional data from other datasets in downstream datasets)\n        -- , trim(\"Month\") as month --Sting representation of the month (Jan., 2018, etc.)\n        -- , \"Residence State Code\" as residence_state_code -- The integer state code is not needed for our analysis\n        -- , population -- Almost always \"Not Applicable\". CDC Wonder attempts to anonymize the data when it is too granular (state, month, etc.)\n        -- , crude_rate -- Almost always \"Not Applicable\". CDC Wonder attempts to anonymize the data when it is too granular (state, month, etc.)\n\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "\"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.369870Z", "completed_at": "2025-10-26T16:51:37.374927Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.377598Z", "completed_at": "2025-10-26T16:51:37.377609Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.023676633834838867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fentanyl_awareness.stg_census_state_economic", "compiled": true, "compiled_code": "-- Staging model for Census Economic Data (ACS)\n-- This model cleans and standardizes state-level economic data from US Census\n\n\n\nwith source_data as (\n    select * from \"fentanyl_awareness\".\"main\".\"census_state_economic\"\n),\n\ncleaned_data as (\n    select\n        -- Clean and standardize columns\n        year\n        , state_code\n        , trim(state_name) as state_name\n        , median_household_income\n        , per_capita_income\n        , unemployment_rate\n        , labor_force_total\n        , employed\n        , unemployed\n        , extracted_at\n        \n        -- Add derived fields\n        , case \n            when median_household_income > 0 \n                then true\n            else false\n          end as has_income_data\n        \n        , case \n            when unemployment_rate is not null \n                then true\n            else false\n          end as has_employment_data\n        \n        -- Add data quality flags\n        , case \n            when median_household_income is null \n                then 'missing'\n            when median_household_income < 20000 \n                then 'low_income'\n            when median_household_income > 150000 \n                then 'high_income'\n            else 'normal'\n          end as income_quality_flag\n        \n        , case \n            when unemployment_rate is null \n                then 'missing'\n            when unemployment_rate < 2.0 \n                then 'very_low'\n            when unemployment_rate > 10.0 \n                then 'very_high'\n            else 'normal'\n          end as unemployment_quality_flag\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "\"fentanyl_awareness\".\"main\".\"stg_census_state_economic\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.387688Z", "completed_at": "2025-10-26T16:51:37.389168Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.393298Z", "completed_at": "2025-10-26T16:51:37.393307Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.011896848678588867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.fentanyl_awareness.Multiple_Cause_of_Death_1999_2020_MANUAL_DOWNLOAD", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.389651Z", "completed_at": "2025-10-26T16:51:37.390970Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.394042Z", "completed_at": "2025-10-26T16:51:37.394055Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.012052536010742188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.fentanyl_awareness.Multiple_Cause_of_Death_2018_2023_Single_Race_MANUAL_DOWNLOAD", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.391441Z", "completed_at": "2025-10-26T16:51:37.392711Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.395175Z", "completed_at": "2025-10-26T16:51:37.395184Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.012702703475952148, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.fentanyl_awareness.Provisional_Mortality_Statistics_2018_through_Last_Week_MANUAL_DOWNLOAD", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.384709Z", "completed_at": "2025-10-26T16:51:37.394768Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.396836Z", "completed_at": "2025-10-26T16:51:37.396845Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016088008880615234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fentanyl_awareness.stg_census_state_population", "compiled": true, "compiled_code": "-- Staging model for Census Population Estimates Program (PEP) data\n-- This model cleans and standardizes state-level population data from US Census\n\n\n\nwith source_data as (\n    select * from \"fentanyl_awareness\".\"main\".\"census_state_population\"\n),\n\ncleaned_data as (\n    select\n        -- Clean and standardize columns\n        year\n        , state_code\n        , trim(state_name) as state_name\n        , population\n        , trim(date_description) as date_description\n        , extracted_at\n        \n        -- Add derived fields\n        , case \n            when population > 0 \n                then true\n            else false\n          end as has_population_data\n        \n        -- Add data quality flags\n        , case \n            when population is null \n                then 'missing'\n            when population = 0 \n                then 'zero'\n            when population < 1000000 \n                then 'low_population'\n            else 'normal'\n          end as population_quality_flag\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "\"fentanyl_awareness\".\"main\".\"stg_census_state_population\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.402089Z", "completed_at": "2025-10-26T16:51:37.404943Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.412854Z", "completed_at": "2025-10-26T16:51:37.412865Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.014863252639770508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.fentanyl_awareness.census_state_economic", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.405398Z", "completed_at": "2025-10-26T16:51:37.406818Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.421198Z", "completed_at": "2025-10-26T16:51:37.421207Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.022733449935913086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.fentanyl_awareness.census_state_population", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.407706Z", "completed_at": "2025-10-26T16:51:37.432216Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.434032Z", "completed_at": "2025-10-26T16:51:37.434040Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03463602066040039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.dbt_utils_unique_combination_of_columns_stg_cdc_wonder_fentanyl_deaths_final_1999_2020_year__month__state__multiple_cause_of_death_code.901b8b60d5", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        year, month, state, multiple_cause_of_death_code\n    from \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"\n    group by year, month, state, multiple_cause_of_death_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.421896Z", "completed_at": "2025-10-26T16:51:37.433148Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.438673Z", "completed_at": "2025-10-26T16:51:37.438682Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.037584543228149414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_1999_2020_month.cdcff2cc71", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"\nwhere month is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.439377Z", "completed_at": "2025-10-26T16:51:37.445802Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.447655Z", "completed_at": "2025-10-26T16:51:37.447663Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.015999555587768555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_1999_2020_multiple_cause_of_death_code.bed7774318", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect multiple_cause_of_death_code\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"\nwhere multiple_cause_of_death_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.434676Z", "completed_at": "2025-10-26T16:51:37.446764Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.448728Z", "completed_at": "2025-10-26T16:51:37.448735Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01768326759338379, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_1999_2020_multiple_cause_of_death.be1f52a345", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect multiple_cause_of_death\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"\nwhere multiple_cause_of_death is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.449385Z", "completed_at": "2025-10-26T16:51:37.459021Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.460882Z", "completed_at": "2025-10-26T16:51:37.460891Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.015718936920166016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_1999_2020_state.1dcc3c474c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"\nwhere state is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.453553Z", "completed_at": "2025-10-26T16:51:37.460415Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.466014Z", "completed_at": "2025-10-26T16:51:37.466024Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01986074447631836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_1999_2020_year.5e72dabf2b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect year\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"\nwhere year is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.461960Z", "completed_at": "2025-10-26T16:51:37.474295Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.476126Z", "completed_at": "2025-10-26T16:51:37.476134Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.017870187759399414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.dbt_utils_unique_combination_of_columns_stg_cdc_wonder_fentanyl_deaths_provisional_2018_current_year__month__state__multiple_cause_of_death_code.54f0f86d80", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        year, month, state, multiple_cause_of_death_code\n    from \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"\n    group by year, month, state, multiple_cause_of_death_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.467287Z", "completed_at": "2025-10-26T16:51:37.475701Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.481035Z", "completed_at": "2025-10-26T16:51:37.481043Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02164006233215332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_provisional_2018_current_month.37db7c3a62", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"\nwhere month is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.477289Z", "completed_at": "2025-10-26T16:51:37.486711Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.488371Z", "completed_at": "2025-10-26T16:51:37.488380Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.014998674392700195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_provisional_2018_current_multiple_cause_of_death.654ce76e47", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect multiple_cause_of_death\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"\nwhere multiple_cause_of_death is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.482309Z", "completed_at": "2025-10-26T16:51:37.489643Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.494801Z", "completed_at": "2025-10-26T16:51:37.494811Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02010631561279297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_provisional_2018_current_multiple_cause_of_death_code.4265088b0e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect multiple_cause_of_death_code\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"\nwhere multiple_cause_of_death_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.491006Z", "completed_at": "2025-10-26T16:51:37.501201Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.506483Z", "completed_at": "2025-10-26T16:51:37.506497Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.019450664520263672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_provisional_2018_current_state.166d773158", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"\nwhere state is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.495587Z", "completed_at": "2025-10-26T16:51:37.501701Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.507331Z", "completed_at": "2025-10-26T16:51:37.507340Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.019621610641479492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_provisional_2018_current_year.71869994fa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect year\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"\nwhere year is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.502603Z", "completed_at": "2025-10-26T16:51:37.513448Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.515048Z", "completed_at": "2025-10-26T16:51:37.515056Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.015745162963867188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.dbt_utils_unique_combination_of_columns_stg_cdc_wonder_fentanyl_deaths_final_2018_2023_year__month__state__multiple_cause_of_death_code.325aeb4158", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        year, month, state, multiple_cause_of_death_code\n    from \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"\n    group by year, month, state, multiple_cause_of_death_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.509706Z", "completed_at": "2025-10-26T16:51:37.516610Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.525216Z", "completed_at": "2025-10-26T16:51:37.525227Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.023203134536743164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_2018_2023_month.4d97ea0bef", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"\nwhere month is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.517543Z", "completed_at": "2025-10-26T16:51:37.527291Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.529171Z", "completed_at": "2025-10-26T16:51:37.529178Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01522517204284668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_2018_2023_multiple_cause_of_death.5fbf9c39cd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect multiple_cause_of_death\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"\nwhere multiple_cause_of_death is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.521292Z", "completed_at": "2025-10-26T16:51:37.528292Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.535256Z", "completed_at": "2025-10-26T16:51:37.535264Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.020853042602539062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_2018_2023_multiple_cause_of_death_code.744e8841ce", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect multiple_cause_of_death_code\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"\nwhere multiple_cause_of_death_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.529797Z", "completed_at": "2025-10-26T16:51:37.542372Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.544368Z", "completed_at": "2025-10-26T16:51:37.544376Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.018421649932861328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_2018_2023_state.48b1d81ab9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"\nwhere state is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.537732Z", "completed_at": "2025-10-26T16:51:37.543933Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.553312Z", "completed_at": "2025-10-26T16:51:37.553323Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02474522590637207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_2018_2023_year.3a4ffbdd11", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect year\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"\nwhere year is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.549197Z", "completed_at": "2025-10-26T16:51:37.556183Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.558116Z", "completed_at": "2025-10-26T16:51:37.558124Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.016364574432373047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_census_state_economic_state_code.9e2bc8eaff", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state_code\nfrom \"fentanyl_awareness\".\"main\".\"stg_census_state_economic\"\nwhere state_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.545009Z", "completed_at": "2025-10-26T16:51:37.557238Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.559189Z", "completed_at": "2025-10-26T16:51:37.559197Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.017948150634765625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.dbt_utils_unique_combination_of_columns_stg_census_state_economic_year__state_code.10b0079039", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        year, state_code\n    from \"fentanyl_awareness\".\"main\".\"stg_census_state_economic\"\n    group by year, state_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.564005Z", "completed_at": "2025-10-26T16:51:37.570180Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.575435Z", "completed_at": "2025-10-26T16:51:37.575445Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01891016960144043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_census_state_economic_year.6ba220ae0f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect year\nfrom \"fentanyl_awareness\".\"main\".\"stg_census_state_economic\"\nwhere year is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.559852Z", "completed_at": "2025-10-26T16:51:37.571081Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.580277Z", "completed_at": "2025-10-26T16:51:37.580287Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02471160888671875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_census_state_economic_state_name.27633bcdad", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state_name\nfrom \"fentanyl_awareness\".\"main\".\"stg_census_state_economic\"\nwhere state_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.571510Z", "completed_at": "2025-10-26T16:51:37.582484Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.584405Z", "completed_at": "2025-10-26T16:51:37.584419Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01614212989807129, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fentanyl_awareness.fact_fentanyl_deaths_over_time", "compiled": true, "compiled_code": "-- Fact table for CDC WONDER Fentanyl Deaths\n-- This model unions all CDC WONDER data sources and prioritizes older, more reliable data\n\n\n\nwith stg_census_state_population as (\n    select\n        year\n        , state_name as state\n        , population\n    from \"fentanyl_awareness\".\"main\".\"stg_census_state_population\"\n),\n\nstg_census_state_economic as (\n    select\n        year\n        , state_name as state\n        , median_household_income\n        , unemployment_rate\n    from \"fentanyl_awareness\".\"main\".\"stg_census_state_economic\"\n),\n\nwonder_data_union as (\n    -- Union all CDC WONDER data sources (union all since no duplicates expected)\n    select\n        year\n        , month\n        , state\n        , deaths\n        , 'Official 1999-2020' as data_source\n        , 1 as priority\n    from \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"\n\n    union all\n\n    select\n        year\n        , month\n        , state\n        , deaths\n        , 'Official 2018-2023' as data_source\n        , 2 as priority\n    from \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"\n\n    union all\n\n    select\n        year\n        , month\n        , state\n        , deaths\n        , 'Provisional 2018-current' as data_source\n        , 3 as priority\n    from \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"\n),\n\n-- Remove duplicates based on primary keys (year, month, state)\n-- Prioritize older data sources (lower priority number = higher priority)\ndeduplicated_data as (\n    select\n        year\n        , month\n        , state\n        , deaths\n        , data_source\n        , priority\n        , row_number() over (\n            partition by year, month, state\n            order by priority asc\n        ) as row_num\n    from wonder_data_union\n),\n\n-- Final format with coalesced deaths, prioritized data source, and census data\nfinal_format as (\n    select\n        deduplicated_data.year\n        , deduplicated_data.month\n        , deduplicated_data.state\n        , coalesce(deduplicated_data.deaths, 0) as deaths\n        , deduplicated_data.data_source\n        , stg_census_state_population.population\n        , stg_census_state_economic.median_household_income\n        , stg_census_state_economic.unemployment_rate\n    from deduplicated_data\n    left join stg_census_state_population\n        on deduplicated_data.year = stg_census_state_population.year\n        and deduplicated_data.state = stg_census_state_population.state\n    left join stg_census_state_economic\n        on deduplicated_data.year = stg_census_state_economic.year\n        and deduplicated_data.state = stg_census_state_economic.state\n    where deduplicated_data.row_num = 1  -- Keep only the highest priority record for each key\n)\n\nselect * from final_format", "relation_name": "\"fentanyl_awareness\".\"main\".\"fact_fentanyl_deaths_over_time\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.576249Z", "completed_at": "2025-10-26T16:51:37.583038Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.585092Z", "completed_at": "2025-10-26T16:51:37.585099Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01597142219543457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.dbt_utils_unique_combination_of_columns_stg_census_state_population_year__state_code.2f649749e3", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        year, state_code\n    from \"fentanyl_awareness\".\"main\".\"stg_census_state_population\"\n    group by year, state_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.587748Z", "completed_at": "2025-10-26T16:51:37.597005Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.603686Z", "completed_at": "2025-10-26T16:51:37.603694Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02032184600830078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_census_state_population_population.faaf0834d5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect population\nfrom \"fentanyl_awareness\".\"main\".\"stg_census_state_population\"\nwhere population is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.591383Z", "completed_at": "2025-10-26T16:51:37.597406Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.604364Z", "completed_at": "2025-10-26T16:51:37.604377Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.020510196685791016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_census_state_population_state_code.a933bad448", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state_code\nfrom \"fentanyl_awareness\".\"main\".\"stg_census_state_population\"\nwhere state_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.598294Z", "completed_at": "2025-10-26T16:51:37.610259Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.612111Z", "completed_at": "2025-10-26T16:51:37.612120Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01697063446044922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_census_state_population_state_name.a0a9c261d6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state_name\nfrom \"fentanyl_awareness\".\"main\".\"stg_census_state_population\"\nwhere state_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.605170Z", "completed_at": "2025-10-26T16:51:37.611690Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.613694Z", "completed_at": "2025-10-26T16:51:37.613702Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.018063783645629883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_census_state_population_year.286e26da5e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect year\nfrom \"fentanyl_awareness\".\"main\".\"stg_census_state_population\"\nwhere year is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.614824Z", "completed_at": "2025-10-26T16:51:37.624589Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.629636Z", "completed_at": "2025-10-26T16:51:37.629654Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.019053936004638672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.dbt_utils_unique_combination_of_columns_fact_fentanyl_deaths_over_time_year__month__state.51d71a6634", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        year, month, state\n    from \"fentanyl_awareness\".\"main\".\"fact_fentanyl_deaths_over_time\"\n    group by year, month, state\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.618652Z", "completed_at": "2025-10-26T16:51:37.629193Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.634164Z", "completed_at": "2025-10-26T16:51:37.634175Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.023023366928100586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_fact_fentanyl_deaths_over_time_data_source.9f81939df3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect data_source\nfrom \"fentanyl_awareness\".\"main\".\"fact_fentanyl_deaths_over_time\"\nwhere data_source is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.625506Z", "completed_at": "2025-10-26T16:51:37.635021Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.636679Z", "completed_at": "2025-10-26T16:51:37.636686Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.014064311981201172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_fact_fentanyl_deaths_over_time_deaths.42cfa0ceda", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deaths\nfrom \"fentanyl_awareness\".\"main\".\"fact_fentanyl_deaths_over_time\"\nwhere deaths is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.630454Z", "completed_at": "2025-10-26T16:51:37.637328Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.638898Z", "completed_at": "2025-10-26T16:51:37.638908Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.015440940856933594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_fact_fentanyl_deaths_over_time_month.c35ccccd74", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month\nfrom \"fentanyl_awareness\".\"main\".\"fact_fentanyl_deaths_over_time\"\nwhere month is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.644059Z", "completed_at": "2025-10-26T16:51:37.647893Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.648784Z", "completed_at": "2025-10-26T16:51:37.648803Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.010576009750366211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_fact_fentanyl_deaths_over_time_year.b81f0f957d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect year\nfrom \"fentanyl_awareness\".\"main\".\"fact_fentanyl_deaths_over_time\"\nwhere year is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:51:37.640479Z", "completed_at": "2025-10-26T16:51:37.648338Z"}, {"name": "execute", "started_at": "2025-10-26T16:51:37.649431Z", "completed_at": "2025-10-26T16:51:37.649445Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011668920516967773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_fact_fentanyl_deaths_over_time_state.aebb3a4df9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state\nfrom \"fentanyl_awareness\".\"main\".\"fact_fentanyl_deaths_over_time\"\nwhere state is null\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 0.41927409172058105, "args": {"project_dir": "/home/runner/work/fentanyl-awareness/fentanyl-awareness/data_engineering/data_build_tool", "show_resource_report": false, "use_colors": true, "log_path": "/home/runner/work/fentanyl-awareness/fentanyl-awareness/data_engineering/data_build_tool/logs", "defer": false, "empty_catalog": false, "log_level_file": "debug", "use_fast_test_edges": false, "introspect": true, "indirect_selection": "eager", "skip_nodes_if_on_run_start_fails": false, "send_anonymous_usage_stats": true, "macro_debugging": false, "require_batched_execution_for_custom_microbatch_strategy": false, "require_generic_test_arguments_property": true, "select": [], "version_check": true, "log_file_max_bytes": 10485760, "require_nested_cumulative_type_params": false, "quiet": false, "require_yaml_configuration_for_mf_time_spines": false, "state_modified_compare_vars": false, "printer_width": 80, "favor_state": false, "upload_to_artifacts_ingest_api": false, "profiles_dir": "/home/runner/.dbt", "validate_macro_args": false, "which": "generate", "warn_error_options": {"error": [], "warn": [], "silence": []}, "require_explicit_package_overrides_for_builtin_materializations": true, "invocation_command": "dbt docs generate --profiles-dir /home/runner/.dbt", "source_freshness_run_project_hooks": true, "print": true, "static_parser": true, "exclude": [], "show_all_deprecations": false, "log_format": "default", "strict_mode": false, "static": false, "write_json": true, "state_modified_compare_more_unrendered_values": false, "log_level": "info", "cache_selected_only": false, "partial_parse_file_diff": true, "require_resource_names_without_spaces": true, "partial_parse": true, "populate_cache": true, "use_colors_file": true, "vars": {}, "compile": true, "log_format_file": "debug", "require_all_warnings_handled_by_warn_error": false}}