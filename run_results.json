{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.13", "generated_at": "2025-10-26T16:49:53.540408Z", "invocation_id": "9387d117-9fe3-47ee-8187-e34e6151973a", "invocation_started_at": "2025-10-26T16:49:52.605409Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.236320Z", "completed_at": "2025-10-26T16:49:53.254542Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.256045Z", "completed_at": "2025-10-26T16:49:53.256070Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02406144142150879, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fentanyl_awareness.stg_cdc_wonder_fentanyl_deaths_final_1999_2020", "compiled": true, "compiled_code": "-- Staging model for CDC WONDER Fentanyl Deaths Final 1999-2020 data\n-- This model cleans and standardizes the raw CDC WONDER data\n\n\n\nwith source_data as (\n    select * from \"fentanyl_awareness\".\"main\".\"multiple_cause_of_death_1999_2020_manual_download\"\n),\n\ncleaned_data as (\n    select\n        -- Clean and standardize columns\n        \"Year Code\" as year\n        , strptime(trim(\"Month Code\"), '%Y/%m')::date as month\n        , trim(\"State\") as state\n        , trim(\"Multiple Cause of death\") as multiple_cause_of_death\n        , trim(\"Multiple Cause of death Code\") as multiple_cause_of_death_code\n        \n        -- Deaths is already an integer, just handle nulls\n        , case \n            when \"Deaths\" is null \n                then 0\n            else \"Deaths\"\n          end as deaths\n\n        -- These columns are available in the raw data, but not needed for our analysis\n        -- , notes -- Always null\n        -- , trim(\"Year\") as year -- String with (provisional and partial sometimes attached) (not needed as we will be prioritizing non-provisional data from other datasets in downstream datasets)\n        -- , trim(\"Month\") as month --Sting representation of the month (Jan., 2018, etc.)\n        -- , \"Residence State Code\" as residence_state_code -- The integer state code is not needed for our analysis\n        -- , population -- Almost always \"Not Applicable\". CDC Wonder attempts to anonymize the data when it is too granular (state, month, etc.)\n        -- , crude_rate -- Almost always \"Not Applicable\". CDC Wonder attempts to anonymize the data when it is too granular (state, month, etc.)\n\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "\"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.244572Z", "completed_at": "2025-10-26T16:49:53.255343Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.257357Z", "completed_at": "2025-10-26T16:49:53.257369Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.023965835571289062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fentanyl_awareness.stg_cdc_wonder_fentanyl_deaths_final_2018_2023", "compiled": true, "compiled_code": "-- Staging model for CDC WONDER Fentanyl Deaths Final 2018-2023 data\n-- This model cleans and standardizes the raw CDC WONDER data\n\n\n\nwith source_data as (\n    select * from \"fentanyl_awareness\".\"main\".\"multiple_cause_of_death_2018_2023_single_race_manual_download\"\n),\n\ncleaned_data as (\n    select\n        -- Clean and standardize columns\n        \"Year Code\" as year\n        , strptime(trim(\"Month Code\"), '%Y/%m')::date as month\n        , trim(\"State\") as state\n        , trim(\"Multiple Cause of death\") as multiple_cause_of_death\n        , trim(\"Multiple Cause of death Code\") as multiple_cause_of_death_code\n        \n        -- Deaths is already an integer, just handle nulls\n        , case \n            when \"Deaths\" is null \n                then 0\n            else \"Deaths\"\n          end as deaths\n\n        -- These columns are available in the raw data, but not needed for our analysis\n        -- , notes -- Always null\n        -- , trim(\"Year\") as year -- String with (provisional and partial sometimes attached) (not needed as we will be prioritizing non-provisional data from other datasets in downstream datasets)\n        -- , trim(\"Month\") as month --Sting representation of the month (Jan., 2018, etc.)\n        -- , \"Residence State Code\" as residence_state_code -- The integer state code is not needed for our analysis\n        -- , population -- Almost always \"Not Applicable\". CDC Wonder attempts to anonymize the data when it is too granular (state, month, etc.)\n        -- , crude_rate -- Almost always \"Not Applicable\". CDC Wonder attempts to anonymize the data when it is too granular (state, month, etc.)\n\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "\"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.247856Z", "completed_at": "2025-10-26T16:49:53.256816Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.259271Z", "completed_at": "2025-10-26T16:49:53.259282Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02466869354248047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fentanyl_awareness.stg_cdc_wonder_fentanyl_deaths_provisional_2018_current", "compiled": true, "compiled_code": "-- Staging model for D176 Provisional 2018-Current data\n-- This model cleans and standardizes the raw CDC WONDER data\n\n\n\nwith source_data as (\n    select * from \"fentanyl_awareness\".\"main\".\"provisional_mortality_statistics_2018_through_last_week_manual_download\"\n),\n\ncleaned_data as (\n    select\n        -- Clean and standardize columns\n        \"Year Code\" as year\n        , strptime(trim(\"Month Code\"), '%Y/%m')::date as month\n        , trim(\"Residence State\") as state\n        , trim(\"Multiple Cause of death\") as multiple_cause_of_death\n        , trim(\"Multiple Cause of death Code\") as multiple_cause_of_death_code\n        \n        -- Deaths is already an integer, just handle nulls\n        , case \n            when \"Deaths\" is null \n                then 0\n            else \"Deaths\"\n          end as deaths\n\n        -- These columns are available in the raw data, but not needed for our analysis\n        -- , notes -- Always null\n        -- , trim(\"Year\") as year -- String with (provisional and partial sometimes attached) (not needed as we will be prioritizing non-provisional data from other datasets in downstream datasets)\n        -- , trim(\"Month\") as month --Sting representation of the month (Jan., 2018, etc.)\n        -- , \"Residence State Code\" as residence_state_code -- The integer state code is not needed for our analysis\n        -- , population -- Almost always \"Not Applicable\". CDC Wonder attempts to anonymize the data when it is too granular (state, month, etc.)\n        -- , crude_rate -- Almost always \"Not Applicable\". CDC Wonder attempts to anonymize the data when it is too granular (state, month, etc.)\n\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "\"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.250970Z", "completed_at": "2025-10-26T16:49:53.258163Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.260751Z", "completed_at": "2025-10-26T16:49:53.260762Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.025556087493896484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fentanyl_awareness.stg_census_state_economic", "compiled": true, "compiled_code": "-- Staging model for Census Economic Data (ACS)\n-- This model cleans and standardizes state-level economic data from US Census\n\n\n\nwith source_data as (\n    select * from \"fentanyl_awareness\".\"main\".\"census_state_economic\"\n),\n\ncleaned_data as (\n    select\n        -- Clean and standardize columns\n        year\n        , state_code\n        , trim(state_name) as state_name\n        , median_household_income\n        , per_capita_income\n        , unemployment_rate\n        , labor_force_total\n        , employed\n        , unemployed\n        , extracted_at\n        \n        -- Add derived fields\n        , case \n            when median_household_income > 0 \n                then true\n            else false\n          end as has_income_data\n        \n        , case \n            when unemployment_rate is not null \n                then true\n            else false\n          end as has_employment_data\n        \n        -- Add data quality flags\n        , case \n            when median_household_income is null \n                then 'missing'\n            when median_household_income < 20000 \n                then 'low_income'\n            when median_household_income > 150000 \n                then 'high_income'\n            else 'normal'\n          end as income_quality_flag\n        \n        , case \n            when unemployment_rate is null \n                then 'missing'\n            when unemployment_rate < 2.0 \n                then 'very_low'\n            when unemployment_rate > 10.0 \n                then 'very_high'\n            else 'normal'\n          end as unemployment_quality_flag\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "\"fentanyl_awareness\".\"main\".\"stg_census_state_economic\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.269135Z", "completed_at": "2025-10-26T16:49:53.270723Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.273865Z", "completed_at": "2025-10-26T16:49:53.273874Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011330127716064453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.fentanyl_awareness.Multiple_Cause_of_Death_1999_2020_MANUAL_DOWNLOAD", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.271789Z", "completed_at": "2025-10-26T16:49:53.273324Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.277074Z", "completed_at": "2025-10-26T16:49:53.277087Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01282811164855957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.fentanyl_awareness.Multiple_Cause_of_Death_2018_2023_Single_Race_MANUAL_DOWNLOAD", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.265729Z", "completed_at": "2025-10-26T16:49:53.274614Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.278345Z", "completed_at": "2025-10-26T16:49:53.278355Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016875505447387695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fentanyl_awareness.stg_census_state_population", "compiled": true, "compiled_code": "-- Staging model for Census Population Estimates Program (PEP) data\n-- This model cleans and standardizes state-level population data from US Census\n\n\n\nwith source_data as (\n    select * from \"fentanyl_awareness\".\"main\".\"census_state_population\"\n),\n\ncleaned_data as (\n    select\n        -- Clean and standardize columns\n        year\n        , state_code\n        , trim(state_name) as state_name\n        , population\n        , trim(date_description) as date_description\n        , extracted_at\n        \n        -- Add derived fields\n        , case \n            when population > 0 \n                then true\n            else false\n          end as has_population_data\n        \n        -- Add data quality flags\n        , case \n            when population is null \n                then 'missing'\n            when population = 0 \n                then 'zero'\n            when population < 1000000 \n                then 'low_population'\n            else 'normal'\n          end as population_quality_flag\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "\"fentanyl_awareness\".\"main\".\"stg_census_state_population\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.275162Z", "completed_at": "2025-10-26T16:49:53.276580Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.279073Z", "completed_at": "2025-10-26T16:49:53.279084Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.013901948928833008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.fentanyl_awareness.Provisional_Mortality_Statistics_2018_through_Last_Week_MANUAL_DOWNLOAD", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.284575Z", "completed_at": "2025-10-26T16:49:53.287344Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.290852Z", "completed_at": "2025-10-26T16:49:53.290865Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010679244995117188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.fentanyl_awareness.census_state_economic", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.288806Z", "completed_at": "2025-10-26T16:49:53.290364Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.309571Z", "completed_at": "2025-10-26T16:49:53.309583Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0274198055267334, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.fentanyl_awareness.census_state_population", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.291547Z", "completed_at": "2025-10-26T16:49:53.315479Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.317453Z", "completed_at": "2025-10-26T16:49:53.317462Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03438925743103027, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.dbt_utils_unique_combination_of_columns_stg_cdc_wonder_fentanyl_deaths_final_1999_2020_year__month__state__multiple_cause_of_death_code.901b8b60d5", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        year, month, state, multiple_cause_of_death_code\n    from \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"\n    group by year, month, state, multiple_cause_of_death_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.301766Z", "completed_at": "2025-10-26T16:49:53.316523Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.318578Z", "completed_at": "2025-10-26T16:49:53.318586Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03500652313232422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_1999_2020_month.cdcff2cc71", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"\nwhere month is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.319233Z", "completed_at": "2025-10-26T16:49:53.329347Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.331418Z", "completed_at": "2025-10-26T16:49:53.331426Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01662421226501465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_1999_2020_multiple_cause_of_death.be1f52a345", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect multiple_cause_of_death\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"\nwhere multiple_cause_of_death is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.323761Z", "completed_at": "2025-10-26T16:49:53.330517Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.332519Z", "completed_at": "2025-10-26T16:49:53.332527Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.016541242599487305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_1999_2020_multiple_cause_of_death_code.bed7774318", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect multiple_cause_of_death_code\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"\nwhere multiple_cause_of_death_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.333173Z", "completed_at": "2025-10-26T16:49:53.342533Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.344546Z", "completed_at": "2025-10-26T16:49:53.344555Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01592564582824707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_1999_2020_state.1dcc3c474c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"\nwhere state is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.337455Z", "completed_at": "2025-10-26T16:49:53.344139Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.349806Z", "completed_at": "2025-10-26T16:49:53.349817Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.019902706146240234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_1999_2020_year.5e72dabf2b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect year\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"\nwhere year is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.345720Z", "completed_at": "2025-10-26T16:49:53.358380Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.360188Z", "completed_at": "2025-10-26T16:49:53.360207Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01835322380065918, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.dbt_utils_unique_combination_of_columns_stg_cdc_wonder_fentanyl_deaths_final_2018_2023_year__month__state__multiple_cause_of_death_code.325aeb4158", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        year, month, state, multiple_cause_of_death_code\n    from \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"\n    group by year, month, state, multiple_cause_of_death_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.351167Z", "completed_at": "2025-10-26T16:49:53.358888Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.360871Z", "completed_at": "2025-10-26T16:49:53.360878Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.017803430557250977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_2018_2023_month.4d97ea0bef", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"\nwhere month is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.361498Z", "completed_at": "2025-10-26T16:49:53.370578Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.372455Z", "completed_at": "2025-10-26T16:49:53.372464Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015362739562988281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_2018_2023_multiple_cause_of_death.5fbf9c39cd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect multiple_cause_of_death\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"\nwhere multiple_cause_of_death is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.365315Z", "completed_at": "2025-10-26T16:49:53.371966Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.373959Z", "completed_at": "2025-10-26T16:49:53.373969Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.016200542449951172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_2018_2023_multiple_cause_of_death_code.744e8841ce", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect multiple_cause_of_death_code\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"\nwhere multiple_cause_of_death_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.375174Z", "completed_at": "2025-10-26T16:49:53.383735Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.385594Z", "completed_at": "2025-10-26T16:49:53.385613Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.014653921127319336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_2018_2023_state.48b1d81ab9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"\nwhere state is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.378740Z", "completed_at": "2025-10-26T16:49:53.384255Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.386282Z", "completed_at": "2025-10-26T16:49:53.386289Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01479482650756836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_2018_2023_year.3a4ffbdd11", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect year\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"\nwhere year is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.387377Z", "completed_at": "2025-10-26T16:49:53.397228Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.398925Z", "completed_at": "2025-10-26T16:49:53.398935Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01610279083251953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.dbt_utils_unique_combination_of_columns_stg_cdc_wonder_fentanyl_deaths_provisional_2018_current_year__month__state__multiple_cause_of_death_code.54f0f86d80", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        year, month, state, multiple_cause_of_death_code\n    from \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"\n    group by year, month, state, multiple_cause_of_death_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.392567Z", "completed_at": "2025-10-26T16:49:53.399630Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.404944Z", "completed_at": "2025-10-26T16:49:53.404954Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.020423173904418945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_provisional_2018_current_month.37db7c3a62", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"\nwhere month is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.400502Z", "completed_at": "2025-10-26T16:49:53.410903Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.412525Z", "completed_at": "2025-10-26T16:49:53.412540Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.015964508056640625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_provisional_2018_current_multiple_cause_of_death.654ce76e47", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect multiple_cause_of_death\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"\nwhere multiple_cause_of_death is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.405816Z", "completed_at": "2025-10-26T16:49:53.413158Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.420322Z", "completed_at": "2025-10-26T16:49:53.420331Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02269887924194336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_provisional_2018_current_multiple_cause_of_death_code.4265088b0e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect multiple_cause_of_death_code\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"\nwhere multiple_cause_of_death_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.413622Z", "completed_at": "2025-10-26T16:49:53.425615Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.427690Z", "completed_at": "2025-10-26T16:49:53.427698Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0180208683013916, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_provisional_2018_current_state.166d773158", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"\nwhere state is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.421223Z", "completed_at": "2025-10-26T16:49:53.427222Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.433214Z", "completed_at": "2025-10-26T16:49:53.433224Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.021312236785888672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_provisional_2018_current_year.71869994fa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect year\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"\nwhere year is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.428893Z", "completed_at": "2025-10-26T16:49:53.440084Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.441673Z", "completed_at": "2025-10-26T16:49:53.441681Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.016771793365478516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.dbt_utils_unique_combination_of_columns_stg_census_state_economic_year__state_code.10b0079039", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        year, state_code\n    from \"fentanyl_awareness\".\"main\".\"stg_census_state_economic\"\n    group by year, state_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.436354Z", "completed_at": "2025-10-26T16:49:53.446594Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.451470Z", "completed_at": "2025-10-26T16:49:53.451479Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.023206472396850586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_census_state_economic_state_code.9e2bc8eaff", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state_code\nfrom \"fentanyl_awareness\".\"main\".\"stg_census_state_economic\"\nwhere state_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.442956Z", "completed_at": "2025-10-26T16:49:53.452884Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.455091Z", "completed_at": "2025-10-26T16:49:53.455099Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01934671401977539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_census_state_economic_state_name.27633bcdad", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state_name\nfrom \"fentanyl_awareness\".\"main\".\"stg_census_state_economic\"\nwhere state_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.447746Z", "completed_at": "2025-10-26T16:49:53.454632Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.460491Z", "completed_at": "2025-10-26T16:49:53.460501Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01992321014404297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_census_state_economic_year.6ba220ae0f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect year\nfrom \"fentanyl_awareness\".\"main\".\"stg_census_state_economic\"\nwhere year is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.456310Z", "completed_at": "2025-10-26T16:49:53.467659Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.469343Z", "completed_at": "2025-10-26T16:49:53.469352Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01723504066467285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fentanyl_awareness.fact_fentanyl_deaths_over_time", "compiled": true, "compiled_code": "-- Fact table for CDC WONDER Fentanyl Deaths\n-- This model unions all CDC WONDER data sources and prioritizes older, more reliable data\n\n\n\nwith stg_census_state_population as (\n    select\n        year\n        , state_name as state\n        , population\n    from \"fentanyl_awareness\".\"main\".\"stg_census_state_population\"\n),\n\nstg_census_state_economic as (\n    select\n        year\n        , state_name as state\n        , median_household_income\n        , unemployment_rate\n    from \"fentanyl_awareness\".\"main\".\"stg_census_state_economic\"\n),\n\nwonder_data_union as (\n    -- Union all CDC WONDER data sources (union all since no duplicates expected)\n    select\n        year\n        , month\n        , state\n        , deaths\n        , 'Official 1999-2020' as data_source\n        , 1 as priority\n    from \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"\n\n    union all\n\n    select\n        year\n        , month\n        , state\n        , deaths\n        , 'Official 2018-2023' as data_source\n        , 2 as priority\n    from \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"\n\n    union all\n\n    select\n        year\n        , month\n        , state\n        , deaths\n        , 'Provisional 2018-current' as data_source\n        , 3 as priority\n    from \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"\n),\n\n-- Remove duplicates based on primary keys (year, month, state)\n-- Prioritize older data sources (lower priority number = higher priority)\ndeduplicated_data as (\n    select\n        year\n        , month\n        , state\n        , deaths\n        , data_source\n        , priority\n        , row_number() over (\n            partition by year, month, state\n            order by priority asc\n        ) as row_num\n    from wonder_data_union\n),\n\n-- Final format with coalesced deaths, prioritized data source, and census data\nfinal_format as (\n    select\n        deduplicated_data.year\n        , deduplicated_data.month\n        , deduplicated_data.state\n        , coalesce(deduplicated_data.deaths, 0) as deaths\n        , deduplicated_data.data_source\n        , stg_census_state_population.population\n        , stg_census_state_economic.median_household_income\n        , stg_census_state_economic.unemployment_rate\n    from deduplicated_data\n    left join stg_census_state_population\n        on deduplicated_data.year = stg_census_state_population.year\n        and deduplicated_data.state = stg_census_state_population.state\n    left join stg_census_state_economic\n        on deduplicated_data.year = stg_census_state_economic.year\n        and deduplicated_data.state = stg_census_state_economic.state\n    where deduplicated_data.row_num = 1  -- Keep only the highest priority record for each key\n)\n\nselect * from final_format", "relation_name": "\"fentanyl_awareness\".\"main\".\"fact_fentanyl_deaths_over_time\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.463535Z", "completed_at": "2025-10-26T16:49:53.470554Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.479244Z", "completed_at": "2025-10-26T16:49:53.479256Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.023616552352905273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.dbt_utils_unique_combination_of_columns_stg_census_state_population_year__state_code.2f649749e3", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        year, state_code\n    from \"fentanyl_awareness\".\"main\".\"stg_census_state_population\"\n    group by year, state_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.470991Z", "completed_at": "2025-10-26T16:49:53.481308Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.483214Z", "completed_at": "2025-10-26T16:49:53.483225Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02029585838317871, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_census_state_population_population.faaf0834d5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect population\nfrom \"fentanyl_awareness\".\"main\".\"stg_census_state_population\"\nwhere population is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.475420Z", "completed_at": "2025-10-26T16:49:53.481880Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.483901Z", "completed_at": "2025-10-26T16:49:53.483909Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.017931699752807617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_census_state_population_state_code.a933bad448", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state_code\nfrom \"fentanyl_awareness\".\"main\".\"stg_census_state_population\"\nwhere state_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.486672Z", "completed_at": "2025-10-26T16:49:53.496329Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.497966Z", "completed_at": "2025-10-26T16:49:53.497978Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.017910242080688477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_census_state_population_state_name.a0a9c261d6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state_name\nfrom \"fentanyl_awareness\".\"main\".\"stg_census_state_population\"\nwhere state_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.492609Z", "completed_at": "2025-10-26T16:49:53.499184Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.504505Z", "completed_at": "2025-10-26T16:49:53.504516Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.021869421005249023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_census_state_population_year.286e26da5e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect year\nfrom \"fentanyl_awareness\".\"main\".\"stg_census_state_population\"\nwhere year is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.500553Z", "completed_at": "2025-10-26T16:49:53.510706Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.512579Z", "completed_at": "2025-10-26T16:49:53.512590Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01581406593322754, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.dbt_utils_unique_combination_of_columns_fact_fentanyl_deaths_over_time_year__month__state.51d71a6634", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        year, month, state\n    from \"fentanyl_awareness\".\"main\".\"fact_fentanyl_deaths_over_time\"\n    group by year, month, state\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.505341Z", "completed_at": "2025-10-26T16:49:53.511230Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.513275Z", "completed_at": "2025-10-26T16:49:53.513283Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.015966176986694336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_fact_fentanyl_deaths_over_time_data_source.9f81939df3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect data_source\nfrom \"fentanyl_awareness\".\"main\".\"fact_fentanyl_deaths_over_time\"\nwhere data_source is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.513926Z", "completed_at": "2025-10-26T16:49:53.523573Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.525152Z", "completed_at": "2025-10-26T16:49:53.525162Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.016024351119995117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_fact_fentanyl_deaths_over_time_deaths.42cfa0ceda", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deaths\nfrom \"fentanyl_awareness\".\"main\".\"fact_fentanyl_deaths_over_time\"\nwhere deaths is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.519309Z", "completed_at": "2025-10-26T16:49:53.526298Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.534456Z", "completed_at": "2025-10-26T16:49:53.534467Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02244877815246582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_fact_fentanyl_deaths_over_time_month.c35ccccd74", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month\nfrom \"fentanyl_awareness\".\"main\".\"fact_fentanyl_deaths_over_time\"\nwhere month is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.530613Z", "completed_at": "2025-10-26T16:49:53.535659Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.536129Z", "completed_at": "2025-10-26T16:49:53.536135Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.012206792831420898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_fact_fentanyl_deaths_over_time_year.b81f0f957d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect year\nfrom \"fentanyl_awareness\".\"main\".\"fact_fentanyl_deaths_over_time\"\nwhere year is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T16:49:53.526735Z", "completed_at": "2025-10-26T16:49:53.536780Z"}, {"name": "execute", "started_at": "2025-10-26T16:49:53.537275Z", "completed_at": "2025-10-26T16:49:53.537282Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014400720596313477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_fact_fentanyl_deaths_over_time_state.aebb3a4df9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state\nfrom \"fentanyl_awareness\".\"main\".\"fact_fentanyl_deaths_over_time\"\nwhere state is null\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 0.4246985912322998, "args": {"introspect": true, "log_file_max_bytes": 10485760, "static": false, "skip_nodes_if_on_run_start_fails": false, "defer": false, "upload_to_artifacts_ingest_api": false, "version_check": true, "require_yaml_configuration_for_mf_time_spines": false, "invocation_command": "dbt docs generate --profiles-dir /home/runner/.dbt", "partial_parse": true, "vars": {}, "macro_debugging": false, "partial_parse_file_diff": true, "send_anonymous_usage_stats": true, "show_all_deprecations": false, "require_explicit_package_overrides_for_builtin_materializations": true, "require_resource_names_without_spaces": true, "state_modified_compare_more_unrendered_values": false, "state_modified_compare_vars": false, "select": [], "compile": true, "source_freshness_run_project_hooks": true, "strict_mode": false, "use_colors": true, "which": "generate", "indirect_selection": "eager", "printer_width": 80, "require_all_warnings_handled_by_warn_error": false, "show_resource_report": false, "use_fast_test_edges": false, "log_level_file": "debug", "log_format": "default", "quiet": false, "require_batched_execution_for_custom_microbatch_strategy": false, "exclude": [], "populate_cache": true, "log_format_file": "debug", "static_parser": true, "favor_state": false, "write_json": true, "require_generic_test_arguments_property": true, "require_nested_cumulative_type_params": false, "use_colors_file": true, "project_dir": "/home/runner/work/fentanyl-awareness/fentanyl-awareness/data_engineering/data_build_tool", "profiles_dir": "/home/runner/.dbt", "validate_macro_args": false, "log_level": "info", "empty_catalog": false, "print": true, "warn_error_options": {"error": [], "warn": [], "silence": []}, "cache_selected_only": false, "log_path": "/home/runner/work/fentanyl-awareness/fentanyl-awareness/data_engineering/data_build_tool/logs"}}