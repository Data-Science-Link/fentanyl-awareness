{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.13", "generated_at": "2025-10-27T12:39:39.946366Z", "invocation_id": "9b2d2088-c49c-40a1-83a0-f362aa8eec27", "invocation_started_at": "2025-10-27T12:39:38.844262Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.609728Z", "completed_at": "2025-10-27T12:39:39.626727Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.631420Z", "completed_at": "2025-10-27T12:39:39.631438Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02637958526611328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fentanyl_awareness.stg_cdc_wonder_fentanyl_deaths_final_1999_2020", "compiled": true, "compiled_code": "-- Staging model for CDC WONDER Fentanyl Deaths Final 1999-2020 data\n-- This model cleans and standardizes the raw CDC WONDER data\n\n\n\nwith source_data as (\n    select * from \"fentanyl_awareness\".\"main\".\"multiple_cause_of_death_1999_2020_manual_download\"\n),\n\ncleaned_data as (\n    select\n        -- Clean and standardize columns\n        \"Year Code\" as year\n        , strptime(trim(\"Month Code\"), '%Y/%m')::date as month\n        , trim(\"State\") as state\n        , trim(\"Multiple Cause of death\") as multiple_cause_of_death\n        , trim(\"Multiple Cause of death Code\") as multiple_cause_of_death_code\n\n        -- Deaths is already an integer, just handle nulls\n        , case\n            when \"Deaths\" is null\n                then 0\n            else \"Deaths\"\n          end as deaths\n\n        -- These columns are available in the raw data, but not needed for our analysis\n        -- , notes -- Always null\n        -- , trim(\"Year\") as year -- String with (provisional and partial sometimes attached) (not needed as we will be prioritizing non-provisional data from other datasets in downstream datasets)\n        -- , trim(\"Month\") as month --Sting representation of the month (Jan., 2018, etc.)\n        -- , \"Residence State Code\" as residence_state_code -- The integer state code is not needed for our analysis\n        -- , population -- Almost always \"Not Applicable\". CDC Wonder attempts to anonymize the data when it is too granular (state, month, etc.)\n        -- , crude_rate -- Almost always \"Not Applicable\". CDC Wonder attempts to anonymize the data when it is too granular (state, month, etc.)\n\n\n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "\"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.618866Z", "completed_at": "2025-10-27T12:39:39.630833Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.632902Z", "completed_at": "2025-10-27T12:39:39.632920Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.026796817779541016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fentanyl_awareness.stg_cdc_wonder_fentanyl_deaths_final_2018_2023", "compiled": true, "compiled_code": "-- Staging model for CDC WONDER Fentanyl Deaths Final 2018-2023 data\n-- This model cleans and standardizes the raw CDC WONDER data\n\n\n\nwith source_data as (\n    select * from \"fentanyl_awareness\".\"main\".\"multiple_cause_of_death_2018_2023_single_race_manual_download\"\n),\n\ncleaned_data as (\n    select\n        -- Clean and standardize columns\n        \"Year Code\" as year\n        , strptime(trim(\"Month Code\"), '%Y/%m')::date as month\n        , trim(\"State\") as state\n        , trim(\"Multiple Cause of death\") as multiple_cause_of_death\n        , trim(\"Multiple Cause of death Code\") as multiple_cause_of_death_code\n\n        -- Deaths is already an integer, just handle nulls\n        , case\n            when \"Deaths\" is null\n                then 0\n            else \"Deaths\"\n          end as deaths\n\n        -- These columns are available in the raw data, but not needed for our analysis\n        -- , notes -- Always null\n        -- , trim(\"Year\") as year -- String with (provisional and partial sometimes attached) (not needed as we will be prioritizing non-provisional data from other datasets in downstream datasets)\n        -- , trim(\"Month\") as month --Sting representation of the month (Jan., 2018, etc.)\n        -- , \"Residence State Code\" as residence_state_code -- The integer state code is not needed for our analysis\n        -- , population -- Almost always \"Not Applicable\". CDC Wonder attempts to anonymize the data when it is too granular (state, month, etc.)\n        -- , crude_rate -- Almost always \"Not Applicable\". CDC Wonder attempts to anonymize the data when it is too granular (state, month, etc.)\n\n\n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "\"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.623062Z", "completed_at": "2025-10-27T12:39:39.632259Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.634982Z", "completed_at": "2025-10-27T12:39:39.634992Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.027074575424194336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fentanyl_awareness.stg_cdc_wonder_fentanyl_deaths_provisional_2018_current", "compiled": true, "compiled_code": "-- Staging model for D176 Provisional 2018-Current data\n-- This model cleans and standardizes the raw CDC WONDER data\n\n\n\nwith source_data as (\n    select * from \"fentanyl_awareness\".\"main\".\"provisional_mortality_statistics_2018_through_last_week_manual_download\"\n),\n\ncleaned_data as (\n    select\n        -- Clean and standardize columns\n        \"Year Code\" as year\n        , strptime(trim(\"Month Code\"), '%Y/%m')::date as month\n        , trim(\"Residence State\") as state\n        , trim(\"Multiple Cause of death\") as multiple_cause_of_death\n        , trim(\"Multiple Cause of death Code\") as multiple_cause_of_death_code\n\n        -- Deaths is already an integer, just handle nulls\n        , case\n            when \"Deaths\" is null\n                then 0\n            else \"Deaths\"\n          end as deaths\n\n        -- These columns are available in the raw data, but not needed for our analysis\n        -- , notes -- Always null\n        -- , trim(\"Year\") as year -- String with (provisional and partial sometimes attached) (not needed as we will be prioritizing non-provisional data from other datasets in downstream datasets)\n        -- , trim(\"Month\") as month --Sting representation of the month (Jan., 2018, etc.)\n        -- , \"Residence State Code\" as residence_state_code -- The integer state code is not needed for our analysis\n        -- , population -- Almost always \"Not Applicable\". CDC Wonder attempts to anonymize the data when it is too granular (state, month, etc.)\n        -- , crude_rate -- Almost always \"Not Applicable\". CDC Wonder attempts to anonymize the data when it is too granular (state, month, etc.)\n\n\n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "\"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.627383Z", "completed_at": "2025-10-27T12:39:39.634345Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.637205Z", "completed_at": "2025-10-27T12:39:39.637217Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.028170347213745117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fentanyl_awareness.stg_census_state_economic", "compiled": true, "compiled_code": "-- Staging model for Census Economic Data (ACS)\n-- This model cleans and standardizes state-level economic data from US Census\n\n\n\nwith source_data as (\n    select * from \"fentanyl_awareness\".\"main\".\"census_state_economic\"\n),\n\ncleaned_data as (\n    select\n        -- Clean and standardize columns\n        year\n        , state_code\n        , trim(state_name) as state_name\n        , median_household_income\n        , per_capita_income\n        , unemployment_rate\n        , labor_force_total\n        , employed\n        , unemployed\n        , extracted_at\n\n        -- Add derived fields\n        , case\n            when median_household_income > 0\n                then true\n            else false\n          end as has_income_data\n\n        , case\n            when unemployment_rate is not null\n                then true\n            else false\n          end as has_employment_data\n\n        -- Add data quality flags\n        , case\n            when median_household_income is null\n                then 'missing'\n            when median_household_income < 20000\n                then 'low_income'\n            when median_household_income > 150000\n                then 'high_income'\n            else 'normal'\n          end as income_quality_flag\n\n        , case\n            when unemployment_rate is null\n                then 'missing'\n            when unemployment_rate < 2.0\n                then 'very_low'\n            when unemployment_rate > 10.0\n                then 'very_high'\n            else 'normal'\n          end as unemployment_quality_flag\n\n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "\"fentanyl_awareness\".\"main\".\"stg_census_state_economic\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.645862Z", "completed_at": "2025-10-27T12:39:39.647426Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.651333Z", "completed_at": "2025-10-27T12:39:39.651346Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.012869596481323242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.fentanyl_awareness.Multiple_Cause_of_Death_1999_2020_MANUAL_DOWNLOAD", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.648636Z", "completed_at": "2025-10-27T12:39:39.650178Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.653998Z", "completed_at": "2025-10-27T12:39:39.654008Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.013782501220703125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.fentanyl_awareness.Multiple_Cause_of_Death_2018_2023_Single_Race_MANUAL_DOWNLOAD", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.641518Z", "completed_at": "2025-10-27T12:39:39.650724Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.654770Z", "completed_at": "2025-10-27T12:39:39.654780Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018394947052001953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fentanyl_awareness.stg_census_state_population", "compiled": true, "compiled_code": "-- Staging model for Census Population Estimates Program (PEP) data\n-- This model cleans and standardizes state-level population data from US Census\n\n\n\nwith source_data as (\n    select * from \"fentanyl_awareness\".\"main\".\"census_state_population\"\n),\n\ncleaned_data as (\n    select\n        -- Clean and standardize columns\n        year\n        , state_code\n        , trim(state_name) as state_name\n        , population\n        , trim(date_description) as date_description\n        , extracted_at\n\n        -- Add derived fields\n        , case\n            when population > 0\n                then true\n            else false\n          end as has_population_data\n\n        -- Add data quality flags\n        , case\n            when population is null\n                then 'missing'\n            when population = 0\n                then 'zero'\n            when population < 1000000\n                then 'low_population'\n            else 'normal'\n          end as population_quality_flag\n\n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "\"fentanyl_awareness\".\"main\".\"stg_census_state_population\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.652114Z", "completed_at": "2025-10-27T12:39:39.653501Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.656094Z", "completed_at": "2025-10-27T12:39:39.656104Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.011359691619873047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.fentanyl_awareness.Provisional_Mortality_Statistics_2018_through_Last_Week_MANUAL_DOWNLOAD", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.662241Z", "completed_at": "2025-10-27T12:39:39.666127Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.679223Z", "completed_at": "2025-10-27T12:39:39.679238Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.021305322647094727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.fentanyl_awareness.census_state_economic", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.667195Z", "completed_at": "2025-10-27T12:39:39.668507Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.692660Z", "completed_at": "2025-10-27T12:39:39.692671Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03344416618347168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.fentanyl_awareness.census_state_population", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.668983Z", "completed_at": "2025-10-27T12:39:39.695010Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.697191Z", "completed_at": "2025-10-27T12:39:39.697203Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.037400245666503906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.dbt_utils_unique_combination_of_columns_stg_cdc_wonder_fentanyl_deaths_final_1999_2020_year__month__state__multiple_cause_of_death_code.901b8b60d5", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        year, month, state, multiple_cause_of_death_code\n    from \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"\n    group by year, month, state, multiple_cause_of_death_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.684197Z", "completed_at": "2025-10-27T12:39:39.695654Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.697976Z", "completed_at": "2025-10-27T12:39:39.697988Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03722548484802246, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_1999_2020_month.cdcff2cc71", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"\nwhere month is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.700862Z", "completed_at": "2025-10-27T12:39:39.712020Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.717538Z", "completed_at": "2025-10-27T12:39:39.717552Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.021502256393432617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_1999_2020_multiple_cause_of_death.be1f52a345", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect multiple_cause_of_death\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"\nwhere multiple_cause_of_death is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.705296Z", "completed_at": "2025-10-27T12:39:39.712979Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.722330Z", "completed_at": "2025-10-27T12:39:39.722341Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.025777101516723633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_1999_2020_multiple_cause_of_death_code.bed7774318", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect multiple_cause_of_death_code\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"\nwhere multiple_cause_of_death_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.713505Z", "completed_at": "2025-10-27T12:39:39.724189Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.726428Z", "completed_at": "2025-10-27T12:39:39.726437Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016600370407104492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_1999_2020_state.1dcc3c474c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"\nwhere state is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.718294Z", "completed_at": "2025-10-27T12:39:39.725385Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.727694Z", "completed_at": "2025-10-27T12:39:39.727702Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.017210006713867188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_1999_2020_year.5e72dabf2b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect year\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"\nwhere year is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.730549Z", "completed_at": "2025-10-27T12:39:39.744846Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.754242Z", "completed_at": "2025-10-27T12:39:39.754255Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.028496742248535156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.dbt_utils_unique_combination_of_columns_stg_cdc_wonder_fentanyl_deaths_final_2018_2023_year__month__state__multiple_cause_of_death_code.325aeb4158", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        year, month, state, multiple_cause_of_death_code\n    from \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"\n    group by year, month, state, multiple_cause_of_death_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.735937Z", "completed_at": "2025-10-27T12:39:39.745329Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.755091Z", "completed_at": "2025-10-27T12:39:39.755101Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.028031110763549805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_2018_2023_month.4d97ea0bef", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"\nwhere month is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.750033Z", "completed_at": "2025-10-27T12:39:39.756678Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.758888Z", "completed_at": "2025-10-27T12:39:39.758901Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01608753204345703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_2018_2023_multiple_cause_of_death_code.744e8841ce", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect multiple_cause_of_death_code\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"\nwhere multiple_cause_of_death_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.745809Z", "completed_at": "2025-10-27T12:39:39.758369Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.760652Z", "completed_at": "2025-10-27T12:39:39.760660Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.025377511978149414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_2018_2023_multiple_cause_of_death.5fbf9c39cd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect multiple_cause_of_death\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"\nwhere multiple_cause_of_death is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.762456Z", "completed_at": "2025-10-27T12:39:39.772769Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.774903Z", "completed_at": "2025-10-27T12:39:39.774915Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01716780662536621, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_2018_2023_state.48b1d81ab9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"\nwhere state is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.767888Z", "completed_at": "2025-10-27T12:39:39.774444Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.784610Z", "completed_at": "2025-10-27T12:39:39.784624Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02508068084716797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_2018_2023_year.3a4ffbdd11", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect year\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"\nwhere year is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.775680Z", "completed_at": "2025-10-27T12:39:39.787608Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.789617Z", "completed_at": "2025-10-27T12:39:39.789626Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02245640754699707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.dbt_utils_unique_combination_of_columns_stg_cdc_wonder_fentanyl_deaths_provisional_2018_current_year__month__state__multiple_cause_of_death_code.54f0f86d80", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        year, month, state, multiple_cause_of_death_code\n    from \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"\n    group by year, month, state, multiple_cause_of_death_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.780013Z", "completed_at": "2025-10-27T12:39:39.788090Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.790338Z", "completed_at": "2025-10-27T12:39:39.790347Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01833629608154297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_provisional_2018_current_month.37db7c3a62", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"\nwhere month is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.791569Z", "completed_at": "2025-10-27T12:39:39.802679Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.804770Z", "completed_at": "2025-10-27T12:39:39.804779Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.017815589904785156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_provisional_2018_current_multiple_cause_of_death.654ce76e47", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect multiple_cause_of_death\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"\nwhere multiple_cause_of_death is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.797118Z", "completed_at": "2025-10-27T12:39:39.804254Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.816719Z", "completed_at": "2025-10-27T12:39:39.816732Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02824878692626953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_provisional_2018_current_multiple_cause_of_death_code.4265088b0e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect multiple_cause_of_death_code\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"\nwhere multiple_cause_of_death_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.812571Z", "completed_at": "2025-10-27T12:39:39.819793Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.821757Z", "completed_at": "2025-10-27T12:39:39.821766Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.019698381423950195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_provisional_2018_current_year.71869994fa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect year\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"\nwhere year is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.805518Z", "completed_at": "2025-10-27T12:39:39.820227Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.822506Z", "completed_at": "2025-10-27T12:39:39.822517Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.021121501922607422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_provisional_2018_current_state.166d773158", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"\nwhere state is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.823719Z", "completed_at": "2025-10-27T12:39:39.835259Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.837421Z", "completed_at": "2025-10-27T12:39:39.837433Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01826190948486328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.dbt_utils_unique_combination_of_columns_stg_census_state_economic_year__state_code.10b0079039", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        year, state_code\n    from \"fentanyl_awareness\".\"main\".\"stg_census_state_economic\"\n    group by year, state_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.829817Z", "completed_at": "2025-10-27T12:39:39.836924Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.846916Z", "completed_at": "2025-10-27T12:39:39.846927Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.026290178298950195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_census_state_economic_state_code.9e2bc8eaff", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state_code\nfrom \"fentanyl_awareness\".\"main\".\"stg_census_state_economic\"\nwhere state_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.842650Z", "completed_at": "2025-10-27T12:39:39.849307Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.851362Z", "completed_at": "2025-10-27T12:39:39.851370Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.016686439514160156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_census_state_economic_year.6ba220ae0f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect year\nfrom \"fentanyl_awareness\".\"main\".\"stg_census_state_economic\"\nwhere year is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.838180Z", "completed_at": "2025-10-27T12:39:39.849772Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.852098Z", "completed_at": "2025-10-27T12:39:39.852111Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018161296844482422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_census_state_economic_state_name.27633bcdad", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state_name\nfrom \"fentanyl_awareness\".\"main\".\"stg_census_state_economic\"\nwhere state_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.854960Z", "completed_at": "2025-10-27T12:39:39.866017Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.871653Z", "completed_at": "2025-10-27T12:39:39.871670Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.021495342254638672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fentanyl_awareness.fact_fentanyl_deaths_over_time", "compiled": true, "compiled_code": "-- Fact table for CDC WONDER Fentanyl Deaths\n-- This model unions all CDC WONDER data sources and prioritizes older, more reliable data\n\n\n\nwith stg_census_state_population as (\n    select\n        year\n        , state_name as state\n        , population\n    from \"fentanyl_awareness\".\"main\".\"stg_census_state_population\"\n),\n\nstg_census_state_economic as (\n    select\n        year\n        , state_name as state\n        , median_household_income\n        , unemployment_rate\n    from \"fentanyl_awareness\".\"main\".\"stg_census_state_economic\"\n),\n\nwonder_data_union as (\n    -- Union all CDC WONDER data sources (union all since no duplicates expected)\n    select\n        year\n        , month\n        , state\n        , deaths\n        , 'Official 1999-2020' as data_source\n        , 1 as priority\n    from \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"\n\n    union all\n\n    select\n        year\n        , month\n        , state\n        , deaths\n        , 'Official 2018-2023' as data_source\n        , 2 as priority\n    from \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"\n\n    union all\n\n    select\n        year\n        , month\n        , state\n        , deaths\n        , 'Provisional 2018-current' as data_source\n        , 3 as priority\n    from \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"\n),\n\n-- Remove duplicates based on primary keys (year, month, state)\n-- Prioritize older data sources (lower priority number = higher priority)\ndeduplicated_data as (\n    select\n        year\n        , month\n        , state\n        , deaths\n        , data_source\n        , priority\n        , row_number() over (\n            partition by year, month, state\n            order by priority asc\n        ) as row_num\n    from wonder_data_union\n),\n\n-- Final format with coalesced deaths, prioritized data source, and census data\nfinal_format as (\n    select\n        deduplicated_data.year\n        , deduplicated_data.month\n        , deduplicated_data.state\n        , coalesce(deduplicated_data.deaths, 0) as deaths\n        , deduplicated_data.data_source\n        , stg_census_state_population.population\n        , stg_census_state_economic.median_household_income\n        , stg_census_state_economic.unemployment_rate\n    from deduplicated_data\n    left join stg_census_state_population\n        on deduplicated_data.year = stg_census_state_population.year\n        and deduplicated_data.state = stg_census_state_population.state\n    left join stg_census_state_economic\n        on deduplicated_data.year = stg_census_state_economic.year\n        and deduplicated_data.state = stg_census_state_economic.state\n    where deduplicated_data.row_num = 1  -- Keep only the highest priority record for each key\n)\n\nselect * from final_format", "relation_name": "\"fentanyl_awareness\".\"main\".\"fact_fentanyl_deaths_over_time\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.859542Z", "completed_at": "2025-10-27T12:39:39.866985Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.876691Z", "completed_at": "2025-10-27T12:39:39.876708Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.025974512100219727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.dbt_utils_unique_combination_of_columns_stg_census_state_population_year__state_code.2f649749e3", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        year, state_code\n    from \"fentanyl_awareness\".\"main\".\"stg_census_state_population\"\n    group by year, state_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.867653Z", "completed_at": "2025-10-27T12:39:39.878497Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.880560Z", "completed_at": "2025-10-27T12:39:39.880568Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.016593456268310547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_census_state_population_population.faaf0834d5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect population\nfrom \"fentanyl_awareness\".\"main\".\"stg_census_state_population\"\nwhere population is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.872624Z", "completed_at": "2025-10-27T12:39:39.881240Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.883357Z", "completed_at": "2025-10-27T12:39:39.883369Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018871784210205078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_census_state_population_state_code.a933bad448", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state_code\nfrom \"fentanyl_awareness\".\"main\".\"stg_census_state_population\"\nwhere state_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.884639Z", "completed_at": "2025-10-27T12:39:39.899208Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.905327Z", "completed_at": "2025-10-27T12:39:39.905342Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.025536775588989258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_census_state_population_state_name.a0a9c261d6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state_name\nfrom \"fentanyl_awareness\".\"main\".\"stg_census_state_population\"\nwhere state_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.893729Z", "completed_at": "2025-10-27T12:39:39.904130Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.906238Z", "completed_at": "2025-10-27T12:39:39.906251Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02455902099609375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_census_state_population_year.286e26da5e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect year\nfrom \"fentanyl_awareness\".\"main\".\"stg_census_state_population\"\nwhere year is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.899754Z", "completed_at": "2025-10-27T12:39:39.911158Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.913075Z", "completed_at": "2025-10-27T12:39:39.913088Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.023375749588012695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.dbt_utils_unique_combination_of_columns_fact_fentanyl_deaths_over_time_year__month__state.51d71a6634", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        year, month, state\n    from \"fentanyl_awareness\".\"main\".\"fact_fentanyl_deaths_over_time\"\n    group by year, month, state\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.907039Z", "completed_at": "2025-10-27T12:39:39.914387Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.916450Z", "completed_at": "2025-10-27T12:39:39.916462Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017969608306884766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_fact_fentanyl_deaths_over_time_data_source.9f81939df3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect data_source\nfrom \"fentanyl_awareness\".\"main\".\"fact_fentanyl_deaths_over_time\"\nwhere data_source is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.918169Z", "completed_at": "2025-10-27T12:39:39.928650Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.934381Z", "completed_at": "2025-10-27T12:39:39.934412Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.020595073699951172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_fact_fentanyl_deaths_over_time_deaths.42cfa0ceda", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deaths\nfrom \"fentanyl_awareness\".\"main\".\"fact_fentanyl_deaths_over_time\"\nwhere deaths is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.923139Z", "completed_at": "2025-10-27T12:39:39.933885Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.939509Z", "completed_at": "2025-10-27T12:39:39.939523Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02474355697631836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_fact_fentanyl_deaths_over_time_month.c35ccccd74", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month\nfrom \"fentanyl_awareness\".\"main\".\"fact_fentanyl_deaths_over_time\"\nwhere month is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.929196Z", "completed_at": "2025-10-27T12:39:39.940308Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.941232Z", "completed_at": "2025-10-27T12:39:39.941242Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.023662328720092773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_fact_fentanyl_deaths_over_time_state.aebb3a4df9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state\nfrom \"fentanyl_awareness\".\"main\".\"fact_fentanyl_deaths_over_time\"\nwhere state is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-27T12:39:39.935247Z", "completed_at": "2025-10-27T12:39:39.941951Z"}, {"name": "execute", "started_at": "2025-10-27T12:39:39.942586Z", "completed_at": "2025-10-27T12:39:39.942595Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014713287353515625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_fact_fentanyl_deaths_over_time_year.b81f0f957d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect year\nfrom \"fentanyl_awareness\".\"main\".\"fact_fentanyl_deaths_over_time\"\nwhere year is null\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 0.48177313804626465, "args": {"require_generic_test_arguments_property": true, "log_format_file": "debug", "log_level": "info", "require_resource_names_without_spaces": true, "use_fast_test_edges": false, "partial_parse": true, "show_resource_report": false, "partial_parse_file_diff": true, "show_all_deprecations": false, "project_dir": "/home/runner/work/fentanyl-awareness/fentanyl-awareness/data_engineering/data_build_tool", "send_anonymous_usage_stats": true, "write_json": true, "which": "generate", "validate_macro_args": false, "compile": true, "select": [], "state_modified_compare_vars": false, "state_modified_compare_more_unrendered_values": false, "empty_catalog": false, "profiles_dir": "/home/runner/.dbt", "static_parser": true, "print": true, "exclude": [], "skip_nodes_if_on_run_start_fails": false, "use_colors": true, "invocation_command": "dbt docs generate --profiles-dir /home/runner/.dbt", "defer": false, "log_path": "/home/runner/work/fentanyl-awareness/fentanyl-awareness/data_engineering/data_build_tool/logs", "require_all_warnings_handled_by_warn_error": false, "introspect": true, "warn_error_options": {"error": [], "warn": [], "silence": []}, "printer_width": 80, "log_file_max_bytes": 10485760, "macro_debugging": false, "log_format": "default", "indirect_selection": "eager", "require_yaml_configuration_for_mf_time_spines": false, "source_freshness_run_project_hooks": true, "log_level_file": "debug", "static": false, "populate_cache": true, "require_explicit_package_overrides_for_builtin_materializations": true, "upload_to_artifacts_ingest_api": false, "vars": {}, "use_colors_file": true, "strict_mode": false, "cache_selected_only": false, "favor_state": false, "quiet": false, "require_batched_execution_for_custom_microbatch_strategy": false, "version_check": true, "require_nested_cumulative_type_params": false}}