{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.13", "generated_at": "2025-10-26T18:06:47.151870Z", "invocation_id": "7ab3671e-63f5-4745-8f7a-580e658c09be", "invocation_started_at": "2025-10-26T18:06:46.103305Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:46.837229Z", "completed_at": "2025-10-26T18:06:46.856216Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:46.857263Z", "completed_at": "2025-10-26T18:06:46.857282Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.024592161178588867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fentanyl_awareness.stg_cdc_wonder_fentanyl_deaths_final_1999_2020", "compiled": true, "compiled_code": "-- Staging model for CDC WONDER Fentanyl Deaths Final 1999-2020 data\n-- This model cleans and standardizes the raw CDC WONDER data\n\n\n\nwith source_data as (\n    select * from \"fentanyl_awareness\".\"main\".\"multiple_cause_of_death_1999_2020_manual_download\"\n),\n\ncleaned_data as (\n    select\n        -- Clean and standardize columns\n        \"Year Code\" as year\n        , strptime(trim(\"Month Code\"), '%Y/%m')::date as month\n        , trim(\"State\") as state\n        , trim(\"Multiple Cause of death\") as multiple_cause_of_death\n        , trim(\"Multiple Cause of death Code\") as multiple_cause_of_death_code\n\n        -- Deaths is already an integer, just handle nulls\n        , case\n            when \"Deaths\" is null\n                then 0\n            else \"Deaths\"\n          end as deaths\n\n        -- These columns are available in the raw data, but not needed for our analysis\n        -- , notes -- Always null\n        -- , trim(\"Year\") as year -- String with (provisional and partial sometimes attached) (not needed as we will be prioritizing non-provisional data from other datasets in downstream datasets)\n        -- , trim(\"Month\") as month --Sting representation of the month (Jan., 2018, etc.)\n        -- , \"Residence State Code\" as residence_state_code -- The integer state code is not needed for our analysis\n        -- , population -- Almost always \"Not Applicable\". CDC Wonder attempts to anonymize the data when it is too granular (state, month, etc.)\n        -- , crude_rate -- Almost always \"Not Applicable\". CDC Wonder attempts to anonymize the data when it is too granular (state, month, etc.)\n\n\n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "\"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:46.846400Z", "completed_at": "2025-10-26T18:06:46.858187Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:46.860462Z", "completed_at": "2025-10-26T18:06:46.860475Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02614569664001465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fentanyl_awareness.stg_cdc_wonder_fentanyl_deaths_final_2018_2023", "compiled": true, "compiled_code": "-- Staging model for CDC WONDER Fentanyl Deaths Final 2018-2023 data\n-- This model cleans and standardizes the raw CDC WONDER data\n\n\n\nwith source_data as (\n    select * from \"fentanyl_awareness\".\"main\".\"multiple_cause_of_death_2018_2023_single_race_manual_download\"\n),\n\ncleaned_data as (\n    select\n        -- Clean and standardize columns\n        \"Year Code\" as year\n        , strptime(trim(\"Month Code\"), '%Y/%m')::date as month\n        , trim(\"State\") as state\n        , trim(\"Multiple Cause of death\") as multiple_cause_of_death\n        , trim(\"Multiple Cause of death Code\") as multiple_cause_of_death_code\n\n        -- Deaths is already an integer, just handle nulls\n        , case\n            when \"Deaths\" is null\n                then 0\n            else \"Deaths\"\n          end as deaths\n\n        -- These columns are available in the raw data, but not needed for our analysis\n        -- , notes -- Always null\n        -- , trim(\"Year\") as year -- String with (provisional and partial sometimes attached) (not needed as we will be prioritizing non-provisional data from other datasets in downstream datasets)\n        -- , trim(\"Month\") as month --Sting representation of the month (Jan., 2018, etc.)\n        -- , \"Residence State Code\" as residence_state_code -- The integer state code is not needed for our analysis\n        -- , population -- Almost always \"Not Applicable\". CDC Wonder attempts to anonymize the data when it is too granular (state, month, etc.)\n        -- , crude_rate -- Almost always \"Not Applicable\". CDC Wonder attempts to anonymize the data when it is too granular (state, month, etc.)\n\n\n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "\"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:46.849672Z", "completed_at": "2025-10-26T18:06:46.859279Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:46.861867Z", "completed_at": "2025-10-26T18:06:46.861880Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.026473283767700195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fentanyl_awareness.stg_cdc_wonder_fentanyl_deaths_provisional_2018_current", "compiled": true, "compiled_code": "-- Staging model for D176 Provisional 2018-Current data\n-- This model cleans and standardizes the raw CDC WONDER data\n\n\n\nwith source_data as (\n    select * from \"fentanyl_awareness\".\"main\".\"provisional_mortality_statistics_2018_through_last_week_manual_download\"\n),\n\ncleaned_data as (\n    select\n        -- Clean and standardize columns\n        \"Year Code\" as year\n        , strptime(trim(\"Month Code\"), '%Y/%m')::date as month\n        , trim(\"Residence State\") as state\n        , trim(\"Multiple Cause of death\") as multiple_cause_of_death\n        , trim(\"Multiple Cause of death Code\") as multiple_cause_of_death_code\n\n        -- Deaths is already an integer, just handle nulls\n        , case\n            when \"Deaths\" is null\n                then 0\n            else \"Deaths\"\n          end as deaths\n\n        -- These columns are available in the raw data, but not needed for our analysis\n        -- , notes -- Always null\n        -- , trim(\"Year\") as year -- String with (provisional and partial sometimes attached) (not needed as we will be prioritizing non-provisional data from other datasets in downstream datasets)\n        -- , trim(\"Month\") as month --Sting representation of the month (Jan., 2018, etc.)\n        -- , \"Residence State Code\" as residence_state_code -- The integer state code is not needed for our analysis\n        -- , population -- Almost always \"Not Applicable\". CDC Wonder attempts to anonymize the data when it is too granular (state, month, etc.)\n        -- , crude_rate -- Almost always \"Not Applicable\". CDC Wonder attempts to anonymize the data when it is too granular (state, month, etc.)\n\n\n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "\"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:46.853042Z", "completed_at": "2025-10-26T18:06:46.859759Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:46.862648Z", "completed_at": "2025-10-26T18:06:46.862659Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02662181854248047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fentanyl_awareness.stg_census_state_economic", "compiled": true, "compiled_code": "-- Staging model for Census Economic Data (ACS)\n-- This model cleans and standardizes state-level economic data from US Census\n\n\n\nwith source_data as (\n    select * from \"fentanyl_awareness\".\"main\".\"census_state_economic\"\n),\n\ncleaned_data as (\n    select\n        -- Clean and standardize columns\n        year\n        , state_code\n        , trim(state_name) as state_name\n        , median_household_income\n        , per_capita_income\n        , unemployment_rate\n        , labor_force_total\n        , employed\n        , unemployed\n        , extracted_at\n\n        -- Add derived fields\n        , case\n            when median_household_income > 0\n                then true\n            else false\n          end as has_income_data\n\n        , case\n            when unemployment_rate is not null\n                then true\n            else false\n          end as has_employment_data\n\n        -- Add data quality flags\n        , case\n            when median_household_income is null\n                then 'missing'\n            when median_household_income < 20000\n                then 'low_income'\n            when median_household_income > 150000\n                then 'high_income'\n            else 'normal'\n          end as income_quality_flag\n\n        , case\n            when unemployment_rate is null\n                then 'missing'\n            when unemployment_rate < 2.0\n                then 'very_low'\n            when unemployment_rate > 10.0\n                then 'very_high'\n            else 'normal'\n          end as unemployment_quality_flag\n\n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "\"fentanyl_awareness\".\"main\".\"stg_census_state_economic\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:46.866490Z", "completed_at": "2025-10-26T18:06:46.871764Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:46.876667Z", "completed_at": "2025-10-26T18:06:46.876677Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015393733978271484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fentanyl_awareness.stg_census_state_population", "compiled": true, "compiled_code": "-- Staging model for Census Population Estimates Program (PEP) data\n-- This model cleans and standardizes state-level population data from US Census\n\n\n\nwith source_data as (\n    select * from \"fentanyl_awareness\".\"main\".\"census_state_population\"\n),\n\ncleaned_data as (\n    select\n        -- Clean and standardize columns\n        year\n        , state_code\n        , trim(state_name) as state_name\n        , population\n        , trim(date_description) as date_description\n        , extracted_at\n\n        -- Add derived fields\n        , case\n            when population > 0\n                then true\n            else false\n          end as has_population_data\n\n        -- Add data quality flags\n        , case\n            when population is null\n                then 'missing'\n            when population = 0\n                then 'zero'\n            when population < 1000000\n                then 'low_population'\n            else 'normal'\n          end as population_quality_flag\n\n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "\"fentanyl_awareness\".\"main\".\"stg_census_state_population\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:46.872729Z", "completed_at": "2025-10-26T18:06:46.874143Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:46.879269Z", "completed_at": "2025-10-26T18:06:46.879278Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.013417243957519531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.fentanyl_awareness.Multiple_Cause_of_Death_1999_2020_MANUAL_DOWNLOAD", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:46.874661Z", "completed_at": "2025-10-26T18:06:46.876171Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:46.880005Z", "completed_at": "2025-10-26T18:06:46.880015Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010599613189697266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.fentanyl_awareness.Multiple_Cause_of_Death_2018_2023_Single_Race_MANUAL_DOWNLOAD", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:46.877435Z", "completed_at": "2025-10-26T18:06:46.878751Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:46.881289Z", "completed_at": "2025-10-26T18:06:46.881303Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.011424779891967773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.fentanyl_awareness.Provisional_Mortality_Statistics_2018_through_Last_Week_MANUAL_DOWNLOAD", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:46.887491Z", "completed_at": "2025-10-26T18:06:46.890266Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:46.903684Z", "completed_at": "2025-10-26T18:06:46.903694Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.020358562469482422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.fentanyl_awareness.census_state_economic", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:46.891388Z", "completed_at": "2025-10-26T18:06:46.892626Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:46.916083Z", "completed_at": "2025-10-26T18:06:46.916092Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.031683921813964844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.fentanyl_awareness.census_state_population", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:46.893133Z", "completed_at": "2025-10-26T18:06:46.918317Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:46.920450Z", "completed_at": "2025-10-26T18:06:46.920458Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03552722930908203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.dbt_utils_unique_combination_of_columns_stg_cdc_wonder_fentanyl_deaths_final_1999_2020_year__month__state__multiple_cause_of_death_code.901b8b60d5", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        year, month, state, multiple_cause_of_death_code\n    from \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"\n    group by year, month, state, multiple_cause_of_death_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:46.907799Z", "completed_at": "2025-10-26T18:06:46.918933Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:46.921245Z", "completed_at": "2025-10-26T18:06:46.921254Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.035340070724487305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_1999_2020_month.cdcff2cc71", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"\nwhere month is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:46.924026Z", "completed_at": "2025-10-26T18:06:46.934365Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:46.939526Z", "completed_at": "2025-10-26T18:06:46.939534Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0202023983001709, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_1999_2020_multiple_cause_of_death.be1f52a345", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect multiple_cause_of_death\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"\nwhere multiple_cause_of_death is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:46.928046Z", "completed_at": "2025-10-26T18:06:46.934844Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:46.940298Z", "completed_at": "2025-10-26T18:06:46.940313Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.020488262176513672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_1999_2020_multiple_cause_of_death_code.bed7774318", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect multiple_cause_of_death_code\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"\nwhere multiple_cause_of_death_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:46.935796Z", "completed_at": "2025-10-26T18:06:46.945735Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:46.947955Z", "completed_at": "2025-10-26T18:06:46.947964Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01578521728515625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_1999_2020_state.1dcc3c474c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"\nwhere state is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:46.941066Z", "completed_at": "2025-10-26T18:06:46.947496Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:46.949710Z", "completed_at": "2025-10-26T18:06:46.949718Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01691436767578125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_1999_2020_year.5e72dabf2b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect year\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"\nwhere year is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:46.951502Z", "completed_at": "2025-10-26T18:06:46.963432Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:46.969126Z", "completed_at": "2025-10-26T18:06:46.969135Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02227616310119629, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.dbt_utils_unique_combination_of_columns_stg_cdc_wonder_fentanyl_deaths_final_2018_2023_year__month__state__multiple_cause_of_death_code.325aeb4158", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        year, month, state, multiple_cause_of_death_code\n    from \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"\n    group by year, month, state, multiple_cause_of_death_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:46.956824Z", "completed_at": "2025-10-26T18:06:46.968480Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:46.974125Z", "completed_at": "2025-10-26T18:06:46.974133Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02550983428955078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_2018_2023_month.4d97ea0bef", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"\nwhere month is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:46.964576Z", "completed_at": "2025-10-26T18:06:46.975640Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:46.977864Z", "completed_at": "2025-10-26T18:06:46.977872Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02163243293762207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_2018_2023_multiple_cause_of_death.5fbf9c39cd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect multiple_cause_of_death\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"\nwhere multiple_cause_of_death is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:46.969852Z", "completed_at": "2025-10-26T18:06:46.977354Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:46.979611Z", "completed_at": "2025-10-26T18:06:46.979622Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.017308950424194336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_2018_2023_multiple_cause_of_death_code.744e8841ce", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect multiple_cause_of_death_code\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"\nwhere multiple_cause_of_death_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:46.981449Z", "completed_at": "2025-10-26T18:06:46.991476Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:46.997149Z", "completed_at": "2025-10-26T18:06:46.997160Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02046036720275879, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_2018_2023_state.48b1d81ab9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"\nwhere state is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:46.986356Z", "completed_at": "2025-10-26T18:06:46.992601Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:47.002563Z", "completed_at": "2025-10-26T18:06:47.002573Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.024067401885986328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_final_2018_2023_year.3a4ffbdd11", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect year\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"\nwhere year is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:46.993131Z", "completed_at": "2025-10-26T18:06:47.004856Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:47.007009Z", "completed_at": "2025-10-26T18:06:47.007017Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.021284818649291992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.dbt_utils_unique_combination_of_columns_stg_cdc_wonder_fentanyl_deaths_provisional_2018_current_year__month__state__multiple_cause_of_death_code.54f0f86d80", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        year, month, state, multiple_cause_of_death_code\n    from \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"\n    group by year, month, state, multiple_cause_of_death_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:46.998055Z", "completed_at": "2025-10-26T18:06:47.005458Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:47.007722Z", "completed_at": "2025-10-26T18:06:47.007731Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.017538070678710938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.dbt_utils_unique_combination_of_columns_stg_census_state_economic_year__state_code.10b0079039", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        year, state_code\n    from \"fentanyl_awareness\".\"main\".\"stg_census_state_economic\"\n    group by year, state_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:47.014458Z", "completed_at": "2025-10-26T18:06:47.021157Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:47.031750Z", "completed_at": "2025-10-26T18:06:47.031761Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.025374650955200195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_provisional_2018_current_multiple_cause_of_death.654ce76e47", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect multiple_cause_of_death\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"\nwhere multiple_cause_of_death is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:47.010462Z", "completed_at": "2025-10-26T18:06:47.027319Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:47.032736Z", "completed_at": "2025-10-26T18:06:47.032745Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02690887451171875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_provisional_2018_current_month.37db7c3a62", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"\nwhere month is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:47.021679Z", "completed_at": "2025-10-26T18:06:47.033566Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:47.035331Z", "completed_at": "2025-10-26T18:06:47.035341Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01680302619934082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_provisional_2018_current_multiple_cause_of_death_code.4265088b0e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect multiple_cause_of_death_code\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"\nwhere multiple_cause_of_death_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:47.027872Z", "completed_at": "2025-10-26T18:06:47.036058Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:47.038128Z", "completed_at": "2025-10-26T18:06:47.038137Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.018929481506347656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_provisional_2018_current_state.166d773158", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"\nwhere state is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:47.044834Z", "completed_at": "2025-10-26T18:06:47.054518Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:47.059480Z", "completed_at": "2025-10-26T18:06:47.059493Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0225064754486084, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_census_state_economic_state_code.9e2bc8eaff", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state_code\nfrom \"fentanyl_awareness\".\"main\".\"stg_census_state_economic\"\nwhere state_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:47.040829Z", "completed_at": "2025-10-26T18:06:47.055020Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:47.060742Z", "completed_at": "2025-10-26T18:06:47.060751Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02430129051208496, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_cdc_wonder_fentanyl_deaths_provisional_2018_current_year.71869994fa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect year\nfrom \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"\nwhere year is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:47.050172Z", "completed_at": "2025-10-26T18:06:47.060258Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:47.062263Z", "completed_at": "2025-10-26T18:06:47.062275Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.022562503814697266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_census_state_economic_state_name.27633bcdad", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state_name\nfrom \"fentanyl_awareness\".\"main\".\"stg_census_state_economic\"\nwhere state_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:47.055611Z", "completed_at": "2025-10-26T18:06:47.062992Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:47.065154Z", "completed_at": "2025-10-26T18:06:47.065163Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01595306396484375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_census_state_economic_year.6ba220ae0f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect year\nfrom \"fentanyl_awareness\".\"main\".\"stg_census_state_economic\"\nwhere year is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:47.068439Z", "completed_at": "2025-10-26T18:06:47.082436Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:47.087768Z", "completed_at": "2025-10-26T18:06:47.087778Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.023790359497070312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fentanyl_awareness.fact_fentanyl_deaths_over_time", "compiled": true, "compiled_code": "-- Fact table for CDC WONDER Fentanyl Deaths\n-- This model unions all CDC WONDER data sources and prioritizes older, more reliable data\n\n\n\nwith stg_census_state_population as (\n    select\n        year\n        , state_name as state\n        , population\n    from \"fentanyl_awareness\".\"main\".\"stg_census_state_population\"\n),\n\nstg_census_state_economic as (\n    select\n        year\n        , state_name as state\n        , median_household_income\n        , unemployment_rate\n    from \"fentanyl_awareness\".\"main\".\"stg_census_state_economic\"\n),\n\nwonder_data_union as (\n    -- Union all CDC WONDER data sources (union all since no duplicates expected)\n    select\n        year\n        , month\n        , state\n        , deaths\n        , 'Official 1999-2020' as data_source\n        , 1 as priority\n    from \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_1999_2020\"\n\n    union all\n\n    select\n        year\n        , month\n        , state\n        , deaths\n        , 'Official 2018-2023' as data_source\n        , 2 as priority\n    from \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_final_2018_2023\"\n\n    union all\n\n    select\n        year\n        , month\n        , state\n        , deaths\n        , 'Provisional 2018-current' as data_source\n        , 3 as priority\n    from \"fentanyl_awareness\".\"main\".\"stg_cdc_wonder_fentanyl_deaths_provisional_2018_current\"\n),\n\n-- Remove duplicates based on primary keys (year, month, state)\n-- Prioritize older data sources (lower priority number = higher priority)\ndeduplicated_data as (\n    select\n        year\n        , month\n        , state\n        , deaths\n        , data_source\n        , priority\n        , row_number() over (\n            partition by year, month, state\n            order by priority asc\n        ) as row_num\n    from wonder_data_union\n),\n\n-- Final format with coalesced deaths, prioritized data source, and census data\nfinal_format as (\n    select\n        deduplicated_data.year\n        , deduplicated_data.month\n        , deduplicated_data.state\n        , coalesce(deduplicated_data.deaths, 0) as deaths\n        , deduplicated_data.data_source\n        , stg_census_state_population.population\n        , stg_census_state_economic.median_household_income\n        , stg_census_state_economic.unemployment_rate\n    from deduplicated_data\n    left join stg_census_state_population\n        on deduplicated_data.year = stg_census_state_population.year\n        and deduplicated_data.state = stg_census_state_population.state\n    left join stg_census_state_economic\n        on deduplicated_data.year = stg_census_state_economic.year\n        and deduplicated_data.state = stg_census_state_economic.state\n    where deduplicated_data.row_num = 1  -- Keep only the highest priority record for each key\n)\n\nselect * from final_format", "relation_name": "\"fentanyl_awareness\".\"main\".\"fact_fentanyl_deaths_over_time\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:47.077920Z", "completed_at": "2025-10-26T18:06:47.087288Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:47.089095Z", "completed_at": "2025-10-26T18:06:47.089105Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02231454849243164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_census_state_population_population.faaf0834d5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect population\nfrom \"fentanyl_awareness\".\"main\".\"stg_census_state_population\"\nwhere population is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:47.073659Z", "completed_at": "2025-10-26T18:06:47.088488Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:47.091081Z", "completed_at": "2025-10-26T18:06:47.091090Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.025326251983642578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.dbt_utils_unique_combination_of_columns_stg_census_state_population_year__state_code.2f649749e3", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        year, state_code\n    from \"fentanyl_awareness\".\"main\".\"stg_census_state_population\"\n    group by year, state_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:47.083233Z", "completed_at": "2025-10-26T18:06:47.089868Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:47.092387Z", "completed_at": "2025-10-26T18:06:47.092396Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.019318103790283203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_census_state_population_state_code.a933bad448", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state_code\nfrom \"fentanyl_awareness\".\"main\".\"stg_census_state_population\"\nwhere state_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:47.099201Z", "completed_at": "2025-10-26T18:06:47.112017Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:47.117132Z", "completed_at": "2025-10-26T18:06:47.117144Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02408576011657715, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_census_state_population_state_name.a0a9c261d6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state_name\nfrom \"fentanyl_awareness\".\"main\".\"stg_census_state_population\"\nwhere state_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:47.103536Z", "completed_at": "2025-10-26T18:06:47.116477Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:47.118602Z", "completed_at": "2025-10-26T18:06:47.118612Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02439284324645996, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_stg_census_state_population_year.286e26da5e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect year\nfrom \"fentanyl_awareness\".\"main\".\"stg_census_state_population\"\nwhere year is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:47.107918Z", "completed_at": "2025-10-26T18:06:47.118032Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:47.120425Z", "completed_at": "2025-10-26T18:06:47.120434Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.024636268615722656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.dbt_utils_unique_combination_of_columns_fact_fentanyl_deaths_over_time_year__month__state.51d71a6634", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        year, month, state\n    from \"fentanyl_awareness\".\"main\".\"fact_fentanyl_deaths_over_time\"\n    group by year, month, state\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:47.112598Z", "completed_at": "2025-10-26T18:06:47.119381Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:47.121826Z", "completed_at": "2025-10-26T18:06:47.121835Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.025044679641723633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_fact_fentanyl_deaths_over_time_data_source.9f81939df3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect data_source\nfrom \"fentanyl_awareness\".\"main\".\"fact_fentanyl_deaths_over_time\"\nwhere data_source is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:47.126708Z", "completed_at": "2025-10-26T18:06:47.143351Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:47.144801Z", "completed_at": "2025-10-26T18:06:47.144811Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02233147621154785, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_fact_fentanyl_deaths_over_time_deaths.42cfa0ceda", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deaths\nfrom \"fentanyl_awareness\".\"main\".\"fact_fentanyl_deaths_over_time\"\nwhere deaths is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:47.130916Z", "completed_at": "2025-10-26T18:06:47.143956Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:47.146464Z", "completed_at": "2025-10-26T18:06:47.146472Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.022916555404663086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_fact_fentanyl_deaths_over_time_month.c35ccccd74", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month\nfrom \"fentanyl_awareness\".\"main\".\"fact_fentanyl_deaths_over_time\"\nwhere month is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:47.135485Z", "completed_at": "2025-10-26T18:06:47.145521Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:47.147333Z", "completed_at": "2025-10-26T18:06:47.147341Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.022198200225830078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_fact_fentanyl_deaths_over_time_state.aebb3a4df9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state\nfrom \"fentanyl_awareness\".\"main\".\"fact_fentanyl_deaths_over_time\"\nwhere state is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-26T18:06:47.139498Z", "completed_at": "2025-10-26T18:06:47.145946Z"}, {"name": "execute", "started_at": "2025-10-26T18:06:47.148057Z", "completed_at": "2025-10-26T18:06:47.148066Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.021931171417236328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fentanyl_awareness.not_null_fact_fentanyl_deaths_over_time_year.b81f0f957d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect year\nfrom \"fentanyl_awareness\".\"main\".\"fact_fentanyl_deaths_over_time\"\nwhere year is null\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 0.4430704116821289, "args": {"require_all_warnings_handled_by_warn_error": false, "show_all_deprecations": false, "state_modified_compare_more_unrendered_values": false, "require_resource_names_without_spaces": true, "write_json": true, "invocation_command": "dbt docs generate --profiles-dir /home/runner/.dbt", "populate_cache": true, "indirect_selection": "eager", "quiet": false, "require_yaml_configuration_for_mf_time_spines": false, "show_resource_report": false, "project_dir": "/home/runner/work/fentanyl-awareness/fentanyl-awareness/data_engineering/data_build_tool", "static_parser": true, "select": [], "use_colors": true, "macro_debugging": false, "favor_state": false, "empty_catalog": false, "source_freshness_run_project_hooks": true, "use_colors_file": true, "vars": {}, "log_path": "/home/runner/work/fentanyl-awareness/fentanyl-awareness/data_engineering/data_build_tool/logs", "partial_parse": true, "cache_selected_only": false, "require_generic_test_arguments_property": true, "strict_mode": false, "introspect": true, "exclude": [], "send_anonymous_usage_stats": true, "partial_parse_file_diff": true, "which": "generate", "log_format_file": "debug", "upload_to_artifacts_ingest_api": false, "use_fast_test_edges": false, "print": true, "require_explicit_package_overrides_for_builtin_materializations": true, "profiles_dir": "/home/runner/.dbt", "log_level": "info", "require_batched_execution_for_custom_microbatch_strategy": false, "compile": true, "log_file_max_bytes": 10485760, "validate_macro_args": false, "printer_width": 80, "static": false, "skip_nodes_if_on_run_start_fails": false, "log_format": "default", "require_nested_cumulative_type_params": false, "defer": false, "version_check": true, "log_level_file": "debug", "warn_error_options": {"error": [], "warn": [], "silence": []}, "state_modified_compare_vars": false}}